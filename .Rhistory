annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1, vjust = 4,size = 7)
# for ARV2 in CuP8 silenced mites:
ARV2_CuP8 <- filter(dat_virus, Gene == "ARV2" & Experiment == "CuP8_exp")
pARV2_CuP8 <- ggboxplot(ARV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "ARV-2 viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
annotate("text", -Inf, Inf, label = "ARV-2", hjust = -3, vjust = 2,size = 7) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1.7, vjust = 4,size = 7)
# for DWVa in CuP8 silenced mites:
DWVa_CuP8 <- filter(dat_virus, Gene == "DWVa" & Experiment == "CuP8_exp")
pDWVa_CuP8 <- ggboxplot(DWVa_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "DWVa viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none",text =   element_text(size=30),axis.text.x=element_blank(),axis.ticks.x=element_blank())  +
annotate("text", -Inf, Inf, label = "DWVa", hjust = -3, vjust = 2,size = 7) +
annotate("text", -Inf, Inf, label = "P = 0.2", hjust = -2.5, vjust = 4,size = 7)
#plot CuP8 gene expression and the viruses load
grid.arrange(pCuP8, pVDV2_CuP8, pARV2_CuP8, pDWVa_CuP8 , nrow = 1)
### plot Figure 3a for the MS
CuP8 <- filter(dat_gene, Gene == "CuP8")
pCuP8 <- ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("#00AFBB", "#E7B800"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "CuP8", hjust = -3, vjust = 2,size = 9,fontface = 'italic') +
annotate("text", -Inf, Inf, label = "P < 0.0001", hjust = -1.5, vjust = 4,size = 9)
### plot Figure 3b for the MS
# for VDV2 in CuP8 silenced mites:
VDV2_CuP8 <- filter(dat_virus, Gene == "VDV2" & Experiment == "CuP8_exp")
pVDV2_CuP8 <- ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "VDV2", hjust = -3, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1, vjust = 4,size = 9)
# for ARV2 in CuP8 silenced mites:
ARV2_CuP8 <- filter(dat_virus, Gene == "ARV2" & Experiment == "CuP8_exp")
pARV2_CuP8 <- ggboxplot(ARV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "ARV-2 viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
annotate("text", -Inf, Inf, label = "ARV-2", hjust = -3, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1.7, vjust = 4,size = 9)
# for DWVa in CuP8 silenced mites:
DWVa_CuP8 <- filter(dat_virus, Gene == "DWVa" & Experiment == "CuP8_exp")
pDWVa_CuP8 <- ggboxplot(DWVa_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "DWVa viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none",text =   element_text(size=30),axis.text.x=element_blank(),axis.ticks.x=element_blank())  +
annotate("text", -Inf, Inf, label = "DWVa", hjust = -3, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.2", hjust = -2.5, vjust = 4,size = 9)
#plot CuP8 gene expression and the viruses load
grid.arrange(pCuP8, pVDV2_CuP8, pARV2_CuP8, pDWVa_CuP8 , nrow = 1)
### plot Figure 3a for the MS
CuP8 <- filter(dat_gene, Gene == "CuP8")
pCuP8 <- ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("#00AFBB", "#E7B800"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "CuP8", hjust = -2, vjust = 2,size = 9,fontface = 'italic') +
annotate("text", -Inf, Inf, label = "P < 0.0001", hjust = -0.5, vjust = 4,size = 9)
### plot Figure 3b for the MS
# for VDV2 in CuP8 silenced mites:
VDV2_CuP8 <- filter(dat_virus, Gene == "VDV2" & Experiment == "CuP8_exp")
pVDV2_CuP8 <- ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "VDV2", hjust = -3, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1, vjust = 4,size = 9)
# for ARV2 in CuP8 silenced mites:
ARV2_CuP8 <- filter(dat_virus, Gene == "ARV2" & Experiment == "CuP8_exp")
pARV2_CuP8 <- ggboxplot(ARV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "ARV-2 viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
annotate("text", -Inf, Inf, label = "ARV-2", hjust = -3, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1.7, vjust = 4,size = 9)
# for DWVa in CuP8 silenced mites:
DWVa_CuP8 <- filter(dat_virus, Gene == "DWVa" & Experiment == "CuP8_exp")
pDWVa_CuP8 <- ggboxplot(DWVa_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "DWVa viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none",text =   element_text(size=30),axis.text.x=element_blank(),axis.ticks.x=element_blank())  +
annotate("text", -Inf, Inf, label = "DWVa", hjust = -3, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.2", hjust = -2.5, vjust = 4,size = 9)
#plot CuP8 gene expression and the viruses load
grid.arrange(pCuP8, pVDV2_CuP8, pARV2_CuP8, pDWVa_CuP8 , nrow = 1)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("#00AFBB", "#E7B800"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "CuP8", hjust = -2, vjust = 2,size = 9,fontface = 'italic') +
annotate("text", -Inf, Inf, label = "P < 0.0001", hjust = -1, vjust = 4,size = 9)
### plot Figure 3a for the MS
CuP8 <- filter(dat_gene, Gene == "CuP8")
pCuP8 <- ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("#00AFBB", "#E7B800"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "CuP8", hjust = -2, vjust = 2,size = 9,fontface = 'italic') +
annotate("text", -Inf, Inf, label = "P < 0.0001", hjust = -1, vjust = 4,size = 9)
### plot Figure 3b for the MS
# for VDV2 in CuP8 silenced mites:
VDV2_CuP8 <- filter(dat_virus, Gene == "VDV2" & Experiment == "CuP8_exp")
pVDV2_CuP8 <- ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "VDV2", hjust = -3, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1, vjust = 4,size = 9)
# for ARV2 in CuP8 silenced mites:
ARV2_CuP8 <- filter(dat_virus, Gene == "ARV2" & Experiment == "CuP8_exp")
pARV2_CuP8 <- ggboxplot(ARV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "ARV-2 viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
annotate("text", -Inf, Inf, label = "ARV-2", hjust = -3, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1.7, vjust = 4,size = 9)
# for DWVa in CuP8 silenced mites:
DWVa_CuP8 <- filter(dat_virus, Gene == "DWVa" & Experiment == "CuP8_exp")
pDWVa_CuP8 <- ggboxplot(DWVa_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "DWVa viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none",text =   element_text(size=30),axis.text.x=element_blank(),axis.ticks.x=element_blank())  +
annotate("text", -Inf, Inf, label = "DWVa", hjust = -3, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.2", hjust = -2.5, vjust = 4,size = 9)
#plot CuP8 gene expression and the viruses load
grid.arrange(pCuP8, pVDV2_CuP8, pARV2_CuP8, pDWVa_CuP8 , nrow = 1)
### plot Figure 3a for the MS
CuP8 <- filter(dat_gene, Gene == "CuP8")
pCuP8 <- ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("#00AFBB", "#E7B800"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "CuP8", hjust = -2, vjust = 2,size = 9,fontface = 'italic') +
annotate("text", -Inf, Inf, label = "P < 0.0001", hjust = -1, vjust = 4,size = 9)
### plot Figure 3b for the MS
# for VDV2 in CuP8 silenced mites:
VDV2_CuP8 <- filter(dat_virus, Gene == "VDV2" & Experiment == "CuP8_exp")
pVDV2_CuP8 <- ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "VDV2", hjust = -2, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1, vjust = 4,size = 9)
# for ARV2 in CuP8 silenced mites:
ARV2_CuP8 <- filter(dat_virus, Gene == "ARV2" & Experiment == "CuP8_exp")
pARV2_CuP8 <- ggboxplot(ARV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "ARV-2 viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
annotate("text", -Inf, Inf, label = "ARV-2", hjust = -2, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1, vjust = 4,size = 9)
# for DWVa in CuP8 silenced mites:
DWVa_CuP8 <- filter(dat_virus, Gene == "DWVa" & Experiment == "CuP8_exp")
pDWVa_CuP8 <- ggboxplot(DWVa_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "DWVa viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none",text =   element_text(size=30),axis.text.x=element_blank(),axis.ticks.x=element_blank())  +
annotate("text", -Inf, Inf, label = "DWVa", hjust = -2, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.2", hjust = -1, vjust = 4,size = 9)
#plot CuP8 gene expression and the viruses load
grid.arrange(pCuP8, pVDV2_CuP8, pARV2_CuP8, pDWVa_CuP8 , nrow = 1)
### plot Figure 3a for the MS
CuP8 <- filter(dat_gene, Gene == "CuP8")
pCuP8 <- ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("#00AFBB", "#E7B800"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "CuP8", hjust = -2, vjust = 2,size = 9,fontface = 'italic') +
annotate("text", -Inf, Inf, label = "P < 0.0001", hjust = -1, vjust = 4,size = 9)
### plot Figure 3b for the MS
# for VDV2 in CuP8 silenced mites:
VDV2_CuP8 <- filter(dat_virus, Gene == "VDV2" & Experiment == "CuP8_exp")
pVDV2_CuP8 <- ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "VDV2", hjust = -2, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1.5, vjust = 4,size = 9)
# for ARV2 in CuP8 silenced mites:
ARV2_CuP8 <- filter(dat_virus, Gene == "ARV2" & Experiment == "CuP8_exp")
pARV2_CuP8 <- ggboxplot(ARV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "ARV-2 viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
annotate("text", -Inf, Inf, label = "ARV-2", hjust = -2, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1.5, vjust = 4,size = 9)
# for DWVa in CuP8 silenced mites:
DWVa_CuP8 <- filter(dat_virus, Gene == "DWVa" & Experiment == "CuP8_exp")
pDWVa_CuP8 <- ggboxplot(DWVa_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "DWVa viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none",text =   element_text(size=30),axis.text.x=element_blank(),axis.ticks.x=element_blank())  +
annotate("text", -Inf, Inf, label = "DWVa", hjust = -1.5, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.2", hjust = -1, vjust = 4,size = 9)
#plot CuP8 gene expression and the viruses load
grid.arrange(pCuP8, pVDV2_CuP8, pARV2_CuP8, pDWVa_CuP8 , nrow = 1)
### plot Figure 3a for the MS
CuP8 <- filter(dat_gene, Gene == "CuP8")
pCuP8 <- ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("#00AFBB", "#E7B800"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "CuP8", hjust = -2, vjust = 2,size = 9,fontface = 'italic') +
annotate("text", -Inf, Inf, label = "P < 0.0001", hjust = -1, vjust = 4,size = 9)
### plot Figure 3b for the MS
# for VDV2 in CuP8 silenced mites:
VDV2_CuP8 <- filter(dat_virus, Gene == "VDV2" & Experiment == "CuP8_exp")
pVDV2_CuP8 <- ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "VDV2", hjust = -2.1, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1.5, vjust = 4,size = 9)
# for ARV2 in CuP8 silenced mites:
ARV2_CuP8 <- filter(dat_virus, Gene == "ARV2" & Experiment == "CuP8_exp")
pARV2_CuP8 <- ggboxplot(ARV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "ARV-2 viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
annotate("text", -Inf, Inf, label = "ARV-2", hjust = -1.9, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1.5, vjust = 4,size = 9)
# for DWVa in CuP8 silenced mites:
DWVa_CuP8 <- filter(dat_virus, Gene == "DWVa" & Experiment == "CuP8_exp")
pDWVa_CuP8 <- ggboxplot(DWVa_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "DWVa viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none",text =   element_text(size=30),axis.text.x=element_blank(),axis.ticks.x=element_blank())  +
annotate("text", -Inf, Inf, label = "DWVa", hjust = -1.5, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.2", hjust = -1.3, vjust = 4,size = 9)
#plot CuP8 gene expression and the viruses load
grid.arrange(pCuP8, pVDV2_CuP8, pARV2_CuP8, pDWVa_CuP8 , nrow = 1)
### plot Figure 3a for the MS
CuP8 <- filter(dat_gene, Gene == "CuP8")
pCuP8 <- ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("#00AFBB", "#E7B800"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "CuP8", hjust = -1.9, vjust = 2,size = 9,fontface = 'italic') +
annotate("text", -Inf, Inf, label = "P < 0.0001", hjust = -1, vjust = 4,size = 9)
### plot Figure 3b for the MS
# for VDV2 in CuP8 silenced mites:
VDV2_CuP8 <- filter(dat_virus, Gene == "VDV2" & Experiment == "CuP8_exp")
pVDV2_CuP8 <- ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.x = element_blank()) +
annotate("text", -Inf, Inf, label = "VDV2", hjust = -2.1, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1.5, vjust = 4,size = 9)
# for ARV2 in CuP8 silenced mites:
ARV2_CuP8 <- filter(dat_virus, Gene == "ARV2" & Experiment == "CuP8_exp")
pARV2_CuP8 <- ggboxplot(ARV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "ARV-2 viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
annotate("text", -Inf, Inf, label = "ARV-2", hjust = -1.8, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.02", hjust = -1.5, vjust = 4,size = 9)
# for DWVa in CuP8 silenced mites:
DWVa_CuP8 <- filter(dat_virus, Gene == "DWVa" & Experiment == "CuP8_exp")
pDWVa_CuP8 <- ggboxplot(DWVa_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "DWVa viral load")  +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(legend.position = "none",text =   element_text(size=30),axis.text.x=element_blank(),axis.ticks.x=element_blank())  +
annotate("text", -Inf, Inf, label = "DWVa", hjust = -1.5, vjust = 2,size = 9) +
annotate("text", -Inf, Inf, label = "P = 0.2", hjust = -1.3, vjust = 4,size = 9)
#plot CuP8 gene expression and the viruses load
grid.arrange(pCuP8, pVDV2_CuP8, pARV2_CuP8, pDWVa_CuP8 , nrow = 1)
library("dplyr")
library("tidyverse")
library("vegan")
library("DESeq2")
library("ggfortify")
library("WGCNA")
options(stringsAsFactors = FALSE) # Allow multi-threading within WGCNA. This helps speed up certain calculations.
library("rmarkdown")
library("knitr") # for the markdown
library("kableExtra") # for creating a scrolling table
library("ggplot2") # for plotting
library("ape") # for mantel.test
library("Biostrings")
library("ggrepel") # for spreading text labels on the plot
library("scales") # for axis labels notation
library("GO.db") # for GO term annotation
library("reshape2")
library("RSQLite")
library("AnnotationDbi") # for GO term annotation
library("GSEABase")
library("GOstats")
library("maps") # for the map background
library("htmltools")
library("rgdal")
library("grid")
library("gridExtra")
library("GeneOverlap") # for making the overlapping genes
library("cluster")
library("rmdformats")
library("corrplot") # for virus-virus correlation
library("viridis")
library("hrbrthemes")
library("ggthemes")
library("RColorBrewer")
library("naniar")
library("kableExtra")
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks") #set the directory as the local GitHub local repository
# Next, we join isoforms that belong to the same gene.
# Load the data frame created in the former chunk
load(file = "/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/kallisto_71.rds")
# Import the varroa transcripts ("target_id") and their corresponding gene ("gene_id").
varroa_isoforms <- read_tsv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/gene2isoform.txt.gz", col_names = c("gene_id", "target_id"))
# Join the varroa transcripts (varroa_isoforms), and the library tpm (df), by the isoform ID ("target_id"). As we do "left_join", the final data frame of "gene_tpm" contain ONLY varroa genes, excluding viruses' tpm.
gene_tpm_71 <-  left_join(varroa_isoforms, df_71, by = "target_id")
# Collapse isoforms ("target_id") to a single row of a gene ("gene_id"), and sum the tpm(s) per gene per library
gene_tpm_collps_71 <- gene_tpm_71 %>%
gather("library","tpm", -target_id, -gene_id) %>%
group_by(gene_id, library) %>%
summarise(gene_tpm_71 = sum(tpm))
# spread the table again, by library
final_gene_tpm_71 <- spread(gene_tpm_collps_71, key = "library", value = "gene_tpm_71") %>% column_to_rownames('gene_id')
# this table will be used for all further analyses
# save(final_gene_tpm_71, file = "/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/final_gene_tpm_71.rds")
# load the table
load(file = "/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/final_gene_tpm_71.rds")
# Before PCA, we transpose the table "final_gene_tpm_71", and transform (log10+0.000001)
final_gene_tpm_71_T<- transposeBigData(log10(final_gene_tpm_71 + 0.000001))
PCA_71 <- prcomp(final_gene_tpm_71_T)
p71 <- autoplot(PCA_71, label = TRUE, x = 1, y = 2)+
ggtitle("a. PCA of 71 libraries based on gene expression")
# Five libraries are obvious outliers: "SRR5109825", "SRR5109827", "SRR533974" , "SRR3927496", "SRR8867385".
final_gene_tpm_66_T <- final_gene_tpm_71_T %>%
rownames_to_column("library") %>%
dplyr::filter(!(library %in% c("SRR5109825", "SRR5109827", "SRR533974" , "SRR3927496", "SRR8867385"))) %>% column_to_rownames("library")
PCA_66 <- prcomp(final_gene_tpm_66_T)
p66 <- autoplot(PCA_66, label = TRUE, x = 1, y = 2)+
ggtitle("b. PCA of 66 libraries based on gene expression")
# plot the two PCA plots side by side:
par(mar = c(4, 4, .1, .1))
p71
p66
# when we remove them and repeat the PCA (Fig S2b), the library scatter more homogeneously.
# plot the two PCA plots side by side:
par(mar = c(4, 4, .1, .1))
p71
p66
p71
load(file = "/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/for_modules.rds")
# Take a look at the data frame (print 5 genes in 10 libraries):
head(for_modules[,1:5], 10)
# Choose a set of soft-thresholding powers
powers = c(c(1:10), seq(from = 12, to=25, by=2))
# Call the network topology analysis function
sft = pickSoftThreshold(for_modules, powerVector = powers, verbose = 5)
# Plot the results:
sft_df <- data.frame(
Power = sft$fitIndices[,1],
sft_signedR2 = -sign(sft$fitIndices[,3])*sft$fitIndices[,2],
mean.k = sft$fitIndices[,5])
# Scale-free topology fit index as a function of the soft-thresholding power
pSI <- ggplot(data = sft_df, aes(x = Power, y = sft_signedR2, label = Power)) +
xlab("Soft Threshold (power)") +
ylab("Scale Free Topology Model Fit,signed R^2") +
ggtitle("Scale independence") +
theme_classic() +
theme(text = element_text(size=16)) +
geom_text(data = sft_df, aes(x = Power, y = sft_signedR2), size=6) +
geom_hline(yintercept = 0.8, col="red") # this line corresponds to using an R^2 cut-off of h
# Mean connectivity as a function of the soft-thresholding power
pMC <- ggplot(data = sft_df, aes(x = Power, y = mean.k, label = powers)) +
xlab("Soft Threshold (power)") +
ylab("Mean Connectivity") +
ggtitle("Mean Connectivity") +
theme_classic() +
theme(text = element_text(size=16)) +
geom_text(data = sft_df, aes(x = Power, y = mean.k), size=6)
par(mar = c(4, 4, .1, .1))
pSI
pMC
