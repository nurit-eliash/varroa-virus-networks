c("GO:0030901","midbrain development",0.010,4.805,-4.291,3.342,-4.272,0.709,0.652),
c("GO:0022603","regulation of anatomical structure morphogenesis",0.902,-3.812,-5.142,5.307,-1.590,0.827,0.653),
c("GO:0098974","postsynaptic actin cytoskeleton organization",0.001,7.013,1.314,2.400,-5.041,0.927,0.656),
c("GO:0034220","ion transmembrane transport",5.548,-5.708,1.540,6.096,-2.738,0.885,0.658),
c("GO:0051147","regulation of muscle cell differentiation",0.020,-4.452,-5.127,3.659,-3.706,0.853,0.660),
c("GO:0060537","muscle tissue development",0.065,6.071,-2.793,4.166,-1.957,0.754,0.661),
c("GO:0001654","eye development",0.105,4.688,-4.230,4.374,-2.128,0.667,0.662),
c("GO:0051338","regulation of transferase activity",0.411,-2.169,-6.220,4.966,-1.677,0.840,0.663),
c("GO:0009582","detection of abiotic stimulus",0.064,0.953,2.368,4.159,-2.975,0.942,0.664),
c("GO:0098609","cell-cell adhesion",0.206,1.673,7.002,4.667,-3.252,0.981,0.665),
c("GO:0061061","muscle structure development",0.111,6.298,-3.050,4.397,-1.346,0.758,0.665),
c("GO:0048880","sensory system development",0.114,4.658,-4.137,4.411,-2.128,0.678,0.667),
c("GO:0003013","circulatory system process",0.088,3.799,-5.536,4.296,-2.670,0.797,0.668),
c("GO:0043090","amino acid import",0.014,-5.687,2.557,3.494,-1.409,0.915,0.670),
c("GO:0051155","positive regulation of striated muscle cell differentiation",0.008,-4.820,-4.693,3.244,-4.137,0.823,0.674),
c("GO:0015802","basic amino acid transport",0.016,-5.873,2.547,3.544,-1.627,0.914,0.676),
c("GO:0034613","cellular protein localization",1.711,-5.753,0.811,5.585,-2.058,0.902,0.678),
c("GO:0060322","head development",0.149,6.217,-2.962,4.526,-1.325,0.753,0.682),
c("GO:0000910","cytokinesis",0.281,6.532,3.389,4.801,-2.834,0.965,0.688),
c("GO:0010927","cellular component assembly involved in morphogenesis",0.036,6.348,-1.740,3.912,-2.632,0.714,0.692),
c("GO:0044093","positive regulation of molecular function",0.684,-2.371,-6.049,5.187,-1.533,0.837,0.696),
c("GO:0006338","chromatin remodeling",0.161,7.322,1.030,4.560,-2.834,0.936,0.699));
one.data <- data.frame(revigo.data);
names(one.data) <- revigo.names;
one.data <- one.data [(one.data$plot_X != "null" & one.data$plot_Y != "null"), ];
one.data$plot_X <- as.numeric( as.character(one.data$plot_X) );
one.data$plot_Y <- as.numeric( as.character(one.data$plot_Y) );
one.data$plot_size <- as.numeric( as.character(one.data$plot_size) );
one.data$value <- as.numeric( as.character(one.data$value) );
one.data$frequency <- as.numeric( as.character(one.data$frequency) );
one.data$uniqueness <- as.numeric( as.character(one.data$uniqueness) );
one.data$dispensability <- as.numeric( as.character(one.data$dispensability) );
#head(one.data);
# --------------------------------------------------------------------------
# Names of the axes, sizes of the numbers and letters, names of the columns,
# etc. can be changed below
p1 <- ggplot( data = one.data );
p1 <- p1 + geom_point( aes( plot_X, plot_Y, colour = value, size = plot_size), alpha = I(0.6) ) + scale_size_area();
p1 <- p1 + scale_colour_gradientn( colours = c("blue", "green", "yellow", "red"), limits = c( min(one.data$value), 0) );
p1 <- p1 + geom_point( aes(plot_X, plot_Y, size = plot_size), shape = 21, fill = "transparent", colour = I (alpha ("black", 0.6) )) + scale_size_area();
p1 <- p1 + scale_size( range=c(5, 30)) + theme_bw(); # + scale_fill_gradientn(colours = heat_hcl(7), limits = c(-300, 0) );
ex <- one.data [ one.data$dispensability < 0.15, ];
p1 <- p1 + geom_text( data = ex, aes(plot_X, plot_Y, label = description), colour = I(alpha("black", 0.85)), size = 3 );
p1 <- p1 + labs (y = "semantic space x", x = "semantic space y");
p1 <- p1 + theme(legend.key = element_blank()) ;
one.x_range = max(one.data$plot_X) - min(one.data$plot_X);
one.y_range = max(one.data$plot_Y) - min(one.data$plot_Y);
p1 <- p1 + xlim(min(one.data$plot_X)-one.x_range/10,max(one.data$plot_X)+one.x_range/10);
p1 <- p1 + ylim(min(one.data$plot_Y)-one.y_range/10,max(one.data$plot_Y)+one.y_range/10);
# --------------------------------------------------------------------------
# Output the plot to screen
p1;
# Uncomment the line below to also save the plot to a file.
# A plotting R script produced by the REVIGO server at http://revigo.irb.hr/
# If you found REVIGO useful in your work, please cite the following reference:
# Supek F et al. "REVIGO summarizes and visualizes long lists of Gene Ontology
# terms" PLoS ONE 2011. doi:10.1371/journal.pone.0021800
# --------------------------------------------------------------------------
# If you don't have the ggplot2 package installed, uncomment the following line:
# install.packages( "ggplot2" );
library( ggplot2 );
# --------------------------------------------------------------------------
# If you don't have the scales package installed, uncomment the following line:
# install.packages( "scales" );
library( scales );
# --------------------------------------------------------------------------
# Here is your data from REVIGO. Scroll down for plot configuration options.
revigo.names <- c("term_ID","description","frequency_%","plot_X","plot_Y","plot_size","value","uniqueness","dispensability");
revigo.data <- rbind(c("GO:0000060","(obsolete) protein import into nucleus, translocation",0.173,-6.850,-2.339,4.470,-1.802,1.000,0.000),
c("GO:0002118","aggressive behavior",0.001,-4.744,-6.124,2.473,-4.599,0.996,0.000),
c("GO:0007596","blood coagulation",0.044,3.313,-2.935,3.993,-7.000,0.651,0.000),
c("GO:0007610","behavior",0.126,-0.590,2.595,4.452,-1.367,1.000,0.000),
c("GO:0007623","circadian rhythm",0.046,-5.700,-0.748,4.011,-2.709,1.000,0.000),
c("GO:0022610","biological adhesion",0.549,-6.645,1.969,5.092,-2.244,1.000,0.000),
c("GO:0032502","developmental process",2.243,-4.415,-4.547,5.703,-1.606,1.000,0.000),
c("GO:0034109","homotypic cell-cell adhesion",0.008,-6.368,-3.723,3.240,-7.523,0.983,0.000),
c("GO:0040011","locomotion",1.012,-5.138,1.230,5.357,-1.369,1.000,0.000),
c("GO:0048511","rhythmic process",0.091,-3.167,2.201,4.309,-2.155,1.000,0.000),
c("GO:0048857","neural nucleus development",0.006,-2.118,-7.136,3.095,-4.599,0.798,0.000),
c("GO:0050896","response to stimulus",12.826,-6.941,0.627,6.460,-1.344,1.000,0.000),
c("GO:0051179","localization",18.989,-1.932,-1.539,6.631,-3.159,1.000,0.000),
c("GO:0051705","(obsolete) multi-organism behavior",0.173,-3.758,-0.419,4.470,-3.536,1.000,0.000),
c("GO:0030029","actin filament-based process",0.361,-5.169,-2.627,4.910,-6.291,0.996,0.004),
c("GO:0006909","phagocytosis",0.034,3.089,6.284,3.888,-2.595,0.940,0.005),
c("GO:0000281","mitotic cytokinesis",0.043,-5.710,-4.994,3.985,-3.618,0.963,0.005),
c("GO:0001775","cell activation",0.108,-7.124,-0.859,4.387,-3.912,0.996,0.005),
c("GO:0006072","glycerol-3-phosphate metabolic process",0.131,-1.976,6.173,4.468,-3.738,0.967,0.006),
c("GO:0030036","actin cytoskeleton organization",0.348,-5.238,3.723,4.893,-5.260,0.912,0.006),
c("GO:0051301","cell division",1.492,-1.768,0.738,5.526,-2.040,0.995,0.007),
c("GO:0006721","terpenoid metabolic process",0.329,4.164,-7.766,4.869,-2.492,0.978,0.041),
c("GO:0006793","phosphorus metabolic process",14.797,-3.248,-2.992,6.522,-3.026,0.988,0.066),
c("GO:1903918","regulation of actin filament severing",0.001,2.010,-0.317,2.121,-4.599,0.913,0.115),
c("GO:1904030","negative regulation of cyclin-dependent protein kinase activity",0.016,6.405,-4.317,3.546,-4.801,0.817,0.138),
c("GO:0045663","positive regulation of myoblast differentiation",0.005,7.076,-1.358,3.067,-4.599,0.831,0.140),
c("GO:0034486","vacuolar transmembrane transport",0.004,1.739,6.569,2.968,-1.627,0.945,0.155),
c("GO:0065009","regulation of molecular function",2.645,5.482,-2.371,5.775,-3.060,0.864,0.201),
c("GO:0007266","Rho protein signal transduction",0.020,6.064,0.559,3.663,-1.608,0.870,0.221),
c("GO:0009612","response to mechanical stimulus",0.032,5.847,3.835,3.852,-6.876,0.946,0.227),
c("GO:0030001","metal ion transport",1.492,2.480,5.562,5.526,-2.401,0.899,0.230),
c("GO:0032970","regulation of actin filament-based process",0.221,6.318,-2.391,4.696,-2.892,0.882,0.234),
c("GO:0098657","import into cell",0.056,1.866,5.167,4.104,-1.562,0.944,0.239),
c("GO:0009628","response to abiotic stimulus",0.584,6.356,3.146,5.118,-3.445,0.962,0.278),
c("GO:0104004","cellular response to environmental stimulus",0.106,5.449,3.098,4.378,-2.749,0.963,0.299),
c("GO:0035902","response to immobilization stress",0.001,7.026,2.421,2.243,-5.041,0.970,0.303),
c("GO:0065008","regulation of biological quality",3.066,5.516,-2.789,5.839,-2.322,0.862,0.320),
c("GO:0051606","detection of stimulus",0.399,5.995,3.290,4.953,-2.709,0.963,0.336),
c("GO:0006468","protein phosphorylation",4.254,-1.553,6.085,5.981,-2.035,0.967,0.337),
c("GO:0021762","substantia nigra development",0.000,-0.355,-6.470,1.908,-4.599,0.754,0.357),
c("GO:0006002","fructose 6-phosphate metabolic process",0.063,-2.539,5.679,4.155,-2.101,0.973,0.360),
c("GO:0002026","regulation of the force of heart contraction",0.004,3.780,-3.554,2.943,-4.272,0.850,0.378),
c("GO:0052646","alditol phosphate metabolic process",0.140,-2.089,5.522,4.497,-3.738,0.971,0.382),
c("GO:0009605","response to external stimulus",1.716,5.962,2.830,5.587,-2.081,0.959,0.389),
c("GO:0003300","cardiac muscle hypertrophy",0.004,1.167,-7.078,2.900,-4.425,0.820,0.402),
c("GO:0007349","cellularization",0.004,-0.326,-6.802,2.911,-4.137,0.726,0.403),
c("GO:0009611","response to wounding",0.101,6.453,2.559,4.355,-4.122,0.961,0.404),
c("GO:0001974","blood vessel remodeling",0.006,1.338,-6.801,3.111,-4.014,0.836,0.413),
c("GO:0046942","carboxylic acid transport",0.344,2.802,5.689,4.889,-2.256,0.900,0.415),
c("GO:0031288","sorocarp morphogenesis",0.001,-2.319,-6.690,2.243,-1.802,0.805,0.423),
c("GO:0097435","supramolecular fiber organization",0.308,-5.231,4.020,4.841,-1.854,0.941,0.423),
c("GO:0046434","organophosphate catabolic process",0.516,-1.919,5.816,5.065,-2.492,0.967,0.426),
c("GO:0006811","ion transport",10.217,2.313,5.837,6.361,-3.580,0.903,0.431),
c("GO:0051091","positive regulation of DNA-binding transcription factor activity",0.054,6.428,-3.798,4.083,-4.418,0.848,0.434),
c("GO:0001895","retina homeostasis",0.014,2.484,-5.131,3.492,-3.706,0.692,0.435),
c("GO:1903920","positive regulation of actin filament severing",0.000,1.524,0.661,0.602,-4.801,0.896,0.438),
c("GO:0090175","regulation of establishment of planar polarity",0.008,7.531,-1.751,3.256,-4.272,0.873,0.444),
c("GO:0048771","tissue remodeling",0.019,1.010,-6.410,3.642,-3.319,0.824,0.444),
c("GO:0055013","cardiac muscle cell development",0.010,-0.110,-6.651,3.369,-4.425,0.659,0.449),
c("GO:0050878","regulation of body fluid levels",0.077,4.189,-3.106,4.240,-6.234,0.838,0.453),
c("GO:0032507","maintenance of protein location in cell",0.045,3.863,-0.787,4.003,-3.902,0.780,0.454),
c("GO:0043044","ATP-dependent chromatin remodeling",0.053,-5.492,3.641,4.073,-4.272,0.940,0.459),
c("GO:0050817","coagulation",0.044,0.999,-6.689,3.997,-7.000,0.815,0.468),
c("GO:0009166","nucleotide catabolic process",0.208,-2.284,5.956,4.671,-1.855,0.961,0.479),
c("GO:0007164","establishment of tissue polarity",0.010,-2.089,-6.841,3.357,-3.193,0.777,0.479),
c("GO:0051090","regulation of DNA-binding transcription factor activity",0.082,6.129,-3.873,4.267,-3.982,0.844,0.483),
c("GO:0051098","regulation of binding",0.067,6.040,-4.445,4.178,-2.632,0.862,0.491));
one.data <- data.frame(revigo.data);
names(one.data) <- revigo.names;
one.data <- one.data [(one.data$plot_X != "null" & one.data$plot_Y != "null"), ];
one.data$plot_X <- as.numeric( as.character(one.data$plot_X) );
one.data$plot_Y <- as.numeric( as.character(one.data$plot_Y) );
one.data$plot_size <- as.numeric( as.character(one.data$plot_size) );
one.data$value <- as.numeric( as.character(one.data$value) );
one.data$frequency <- as.numeric( as.character(one.data$frequency) );
one.data$uniqueness <- as.numeric( as.character(one.data$uniqueness) );
one.data$dispensability <- as.numeric( as.character(one.data$dispensability) );
#head(one.data);
# --------------------------------------------------------------------------
# Names of the axes, sizes of the numbers and letters, names of the columns,
# etc. can be changed below
p1 <- ggplot( data = one.data );
p1 <- p1 + geom_point( aes( plot_X, plot_Y, colour = value, size = plot_size), alpha = I(0.6) ) + scale_size_area();
p1 <- p1 + scale_colour_gradientn( colours = c("blue", "green", "yellow", "red"), limits = c( min(one.data$value), 0) );
p1 <- p1 + geom_point( aes(plot_X, plot_Y, size = plot_size), shape = 21, fill = "transparent", colour = I (alpha ("black", 0.6) )) + scale_size_area();
p1 <- p1 + scale_size( range=c(5, 30)) + theme_bw(); # + scale_fill_gradientn(colours = heat_hcl(7), limits = c(-300, 0) );
ex <- one.data [ one.data$dispensability < 0.15, ];
p1 <- p1 + geom_text( data = ex, aes(plot_X, plot_Y, label = description), colour = I(alpha("black", 0.85)), size = 3 );
p1 <- p1 + labs (y = "semantic space x", x = "semantic space y");
p1 <- p1 + theme(legend.key = element_blank()) ;
one.x_range = max(one.data$plot_X) - min(one.data$plot_X);
one.y_range = max(one.data$plot_Y) - min(one.data$plot_Y);
p1 <- p1 + xlim(min(one.data$plot_X)-one.x_range/10,max(one.data$plot_X)+one.x_range/10);
p1 <- p1 + ylim(min(one.data$plot_Y)-one.y_range/10,max(one.data$plot_Y)+one.y_range/10);
# --------------------------------------------------------------------------
# Output the plot to screen
p1;
# Uncomment the line below to also save the plot to a file.
# The file type depends on the extension (default=pdf).
# ggsave("/path_to_your_file/revigo-plot.pdf");
# A plotting R script produced by the REVIGO server at http://revigo.irb.hr/
# If you found REVIGO useful in your work, please cite the following reference:
# Supek F et al. "REVIGO summarizes and visualizes long lists of Gene Ontology
# terms" PLoS ONE 2011. doi:10.1371/journal.pone.0021800
# --------------------------------------------------------------------------
# If you don't have the ggplot2 package installed, uncomment the following line:
# install.packages( "ggplot2" );
library( ggplot2 );
# --------------------------------------------------------------------------
# If you don't have the scales package installed, uncomment the following line:
# install.packages( "scales" );
library( scales );
# --------------------------------------------------------------------------
# Here is your data from REVIGO. Scroll down for plot configuration options.
revigo.names <- c("term_ID","description","frequency_%","plot_X","plot_Y","plot_size","value","uniqueness","dispensability");
revigo.data <- rbind(c("GO:0000060","(obsolete) protein import into nucleus, translocation",0.173,0.219,5.758,4.470,-1.802,1.000,0.000),
c("GO:0002118","aggressive behavior",0.001,-1.133,7.979,2.473,-4.599,0.996,0.000),
c("GO:0007596","blood coagulation",0.044,-5.845,1.201,3.993,-7.000,0.651,0.000),
c("GO:0007610","behavior",0.126,-0.481,-5.550,4.452,-1.367,1.000,0.000),
c("GO:0007623","circadian rhythm",0.046,6.019,2.929,4.011,-2.709,1.000,0.000),
c("GO:0022610","biological adhesion",0.549,-5.932,-5.367,5.092,-2.244,1.000,0.000),
c("GO:0032502","developmental process",2.243,0.788,3.004,5.703,-1.606,1.000,0.000),
c("GO:0034109","homotypic cell-cell adhesion",0.008,2.624,4.857,3.240,-7.523,0.983,0.000),
c("GO:0040011","locomotion",1.012,3.485,2.448,5.357,-1.369,1.000,0.000),
c("GO:0048511","rhythmic process",0.091,-2.904,-4.480,4.309,-2.155,1.000,0.000),
c("GO:0048857","neural nucleus development",0.006,-0.528,-0.167,3.095,-4.599,0.798,0.000),
c("GO:0050896","response to stimulus",12.826,-1.149,-7.199,6.460,-1.344,1.000,0.000),
c("GO:0051179","localization",18.989,1.003,-6.892,6.631,-3.159,1.000,0.000),
c("GO:0051705","(obsolete) multi-organism behavior",0.173,-0.243,-3.278,4.470,-3.536,1.000,0.000),
c("GO:0030029","actin filament-based process",0.361,4.144,5.970,4.910,-6.291,0.996,0.004),
c("GO:0006909","phagocytosis",0.034,6.119,0.430,3.888,-2.595,0.940,0.005),
c("GO:0000281","mitotic cytokinesis",0.043,2.398,7.083,3.985,-3.618,0.963,0.005),
c("GO:0001775","cell activation",0.108,-4.525,-6.101,4.387,-3.912,0.996,0.005),
c("GO:0006072","glycerol-3-phosphate metabolic process",0.131,3.719,-4.858,4.468,-3.738,0.967,0.006),
c("GO:0030036","actin cytoskeleton organization",0.348,-2.962,-6.785,4.893,-5.260,0.912,0.006),
c("GO:0051301","cell division",1.492,2.219,-0.592,5.526,-2.040,0.995,0.007),
c("GO:0006721","terpenoid metabolic process",0.329,5.206,4.417,4.869,-2.492,0.978,0.041),
c("GO:0006793","phosphorus metabolic process",14.797,0.639,7.732,6.522,-3.026,0.988,0.066),
c("GO:1903918","regulation of actin filament severing",0.001,-3.109,6.709,2.121,-4.599,0.913,0.115),
c("GO:1904030","negative regulation of cyclin-dependent protein kinase activity",0.016,-3.538,4.668,3.546,-4.801,0.817,0.138),
c("GO:0045663","positive regulation of myoblast differentiation",0.005,-4.758,6.400,3.067,-4.599,0.831,0.140),
c("GO:0034486","vacuolar transmembrane transport",0.004,5.881,-1.584,2.968,-1.627,0.945,0.155),
c("GO:0065009","regulation of molecular function",2.645,-4.922,4.518,5.775,-3.060,0.864,0.201),
c("GO:0007266","Rho protein signal transduction",0.020,-6.697,1.510,3.663,-1.608,0.870,0.221),
c("GO:0009612","response to mechanical stimulus",0.032,-7.337,-1.748,3.852,-6.876,0.946,0.227),
c("GO:0030001","metal ion transport",1.492,6.058,-0.512,5.526,-2.401,0.899,0.230),
c("GO:0032970","regulation of actin filament-based process",0.221,-5.539,5.339,4.696,-2.892,0.882,0.234),
c("GO:0098657","import into cell",0.056,5.278,-0.300,4.104,-1.562,0.944,0.239),
c("GO:0009628","response to abiotic stimulus",0.584,-7.446,-0.394,5.118,-3.445,0.962,0.278),
c("GO:0104004","cellular response to environmental stimulus",0.106,-6.527,-0.978,4.378,-2.749,0.963,0.299),
c("GO:0035902","response to immobilization stress",0.001,-6.134,-2.052,2.243,-5.041,0.970,0.303),
c("GO:0065008","regulation of biological quality",3.066,-5.477,4.559,5.839,-2.322,0.862,0.320),
c("GO:0051606","detection of stimulus",0.399,-7.494,-0.936,4.953,-2.709,0.963,0.336),
c("GO:0006468","protein phosphorylation",4.254,3.993,-4.357,5.981,-2.035,0.967,0.337),
c("GO:0021762","substantia nigra development",0.000,-1.650,0.098,1.908,-4.599,0.754,0.357),
c("GO:0006002","fructose 6-phosphate metabolic process",0.063,3.215,-4.989,4.155,-2.101,0.973,0.360),
c("GO:0002026","regulation of the force of heart contraction",0.004,-6.936,4.028,2.943,-4.272,0.850,0.378),
c("GO:0052646","alditol phosphate metabolic process",0.140,3.381,-4.443,4.497,-3.738,0.971,0.382),
c("GO:0009605","response to external stimulus",1.716,-7.017,-0.690,5.587,-2.081,0.959,0.389));
one.data <- data.frame(revigo.data);
names(one.data) <- revigo.names;
one.data <- one.data [(one.data$plot_X != "null" & one.data$plot_Y != "null"), ];
one.data$plot_X <- as.numeric( as.character(one.data$plot_X) );
one.data$plot_Y <- as.numeric( as.character(one.data$plot_Y) );
one.data$plot_size <- as.numeric( as.character(one.data$plot_size) );
one.data$value <- as.numeric( as.character(one.data$value) );
one.data$frequency <- as.numeric( as.character(one.data$frequency) );
one.data$uniqueness <- as.numeric( as.character(one.data$uniqueness) );
one.data$dispensability <- as.numeric( as.character(one.data$dispensability) );
#head(one.data);
# --------------------------------------------------------------------------
# Names of the axes, sizes of the numbers and letters, names of the columns,
# etc. can be changed below
p1 <- ggplot( data = one.data );
p1 <- p1 + geom_point( aes( plot_X, plot_Y, colour = value, size = plot_size), alpha = I(0.6) ) + scale_size_area();
p1 <- p1 + scale_colour_gradientn( colours = c("blue", "green", "yellow", "red"), limits = c( min(one.data$value), 0) );
p1 <- p1 + geom_point( aes(plot_X, plot_Y, size = plot_size), shape = 21, fill = "transparent", colour = I (alpha ("black", 0.6) )) + scale_size_area();
p1 <- p1 + scale_size( range=c(5, 30)) + theme_bw(); # + scale_fill_gradientn(colours = heat_hcl(7), limits = c(-300, 0) );
ex <- one.data [ one.data$dispensability < 0.15, ];
p1 <- p1 + geom_text( data = ex, aes(plot_X, plot_Y, label = description), colour = I(alpha("black", 0.85)), size = 3 );
p1 <- p1 + labs (y = "semantic space x", x = "semantic space y");
p1 <- p1 + theme(legend.key = element_blank()) ;
one.x_range = max(one.data$plot_X) - min(one.data$plot_X);
one.y_range = max(one.data$plot_Y) - min(one.data$plot_Y);
p1 <- p1 + xlim(min(one.data$plot_X)-one.x_range/10,max(one.data$plot_X)+one.x_range/10);
p1 <- p1 + ylim(min(one.data$plot_Y)-one.y_range/10,max(one.data$plot_Y)+one.y_range/10);
# --------------------------------------------------------------------------
# Output the plot to screen
p1;
# Uncomment the line below to also save the plot to a file.
# The file type depends on the extension (default=pdf).
# ggsave("/path_to_your_file/revigo-plot.pdf");
# A plotting R script produced by the REVIGO server at http://revigo.irb.hr/
# If you found REVIGO useful in your work, please cite the following reference:
# Supek F et al. "REVIGO summarizes and visualizes long lists of Gene Ontology
# terms" PLoS ONE 2011. doi:10.1371/journal.pone.0021800
# --------------------------------------------------------------------------
# If you don't have the ggplot2 package installed, uncomment the following line:
# install.packages( "ggplot2" );
library( ggplot2 );
# --------------------------------------------------------------------------
# If you don't have the scales package installed, uncomment the following line:
# install.packages( "scales" );
library( scales );
# --------------------------------------------------------------------------
# Here is your data from REVIGO. Scroll down for plot configuration options.
revigo.names <- c("term_ID","description","frequency_%","plot_X","plot_Y","plot_size","value","uniqueness","dispensability");
revigo.data <- rbind(c("GO:0002118","aggressive behavior",0.001,-4.212,6.566,2.473,-4.599,0.979,0.000),
c("GO:0007596","blood coagulation",0.044,-3.106,-0.418,3.993,-7.000,0.516,0.000),
c("GO:0034109","homotypic cell-cell adhesion",0.008,6.576,0.649,3.240,-7.523,0.974,0.000),
c("GO:0048857","neural nucleus development",0.006,-6.543,-3.707,3.095,-4.599,0.890,0.000),
c("GO:0030029","actin filament-based process",0.361,-6.400,5.775,4.910,-6.291,0.997,0.004),
c("GO:0030036","actin cytoskeleton organization",0.348,5.257,3.573,4.893,-5.260,0.885,0.006),
c("GO:1903918","regulation of actin filament severing",0.001,5.164,-1.888,2.121,-4.599,0.890,0.115),
c("GO:1904030","negative regulation of cyclin-dependent protein kinase activity",0.016,1.721,-6.178,3.546,-4.801,0.859,0.138),
c("GO:0045663","positive regulation of myoblast differentiation",0.005,3.622,-3.736,3.067,-4.599,0.792,0.140),
c("GO:0009612","response to mechanical stimulus",0.032,0.054,6.025,3.852,-6.876,0.856,0.227),
c("GO:0035902","response to immobilization stress",0.001,-1.920,5.640,2.243,-5.041,0.911,0.303),
c("GO:0021762","substantia nigra development",0.000,-6.058,-1.832,1.908,-4.599,0.761,0.357),
c("GO:0002026","regulation of the force of heart contraction",0.004,-1.812,-6.325,2.943,-4.272,0.850,0.378),
c("GO:0003300","cardiac muscle hypertrophy",0.004,-6.625,0.522,2.900,-4.425,0.722,0.402),
c("GO:0007349","cellularization",0.004,-6.736,-1.011,2.911,-4.137,0.751,0.403),
c("GO:0009611","response to wounding",0.101,-1.085,5.155,4.355,-4.122,0.887,0.404),
c("GO:0001974","blood vessel remodeling",0.006,-6.080,0.589,3.111,-4.014,0.778,0.413),
c("GO:0051091","positive regulation of DNA-binding transcription factor activity",0.054,1.570,-5.648,4.083,-4.418,0.875,0.434),
c("GO:1903920","positive regulation of actin filament severing",0.000,5.493,-2.450,0.602,-4.801,0.861,0.438),
c("GO:0090175","regulation of establishment of planar polarity",0.008,2.457,-3.490,3.256,-4.272,0.842,0.444),
c("GO:0055013","cardiac muscle cell development",0.010,-5.983,-0.935,3.369,-4.425,0.704,0.449),
c("GO:0050878","regulation of body fluid levels",0.077,-1.037,-5.537,4.240,-6.234,0.830,0.453),
c("GO:0043044","ATP-dependent chromatin remodeling",0.053,5.090,4.043,4.073,-4.272,0.946,0.459),
c("GO:0050817","coagulation",0.044,-5.861,0.136,3.997,-7.000,0.756,0.468),
c("GO:0006874","cellular calcium ion homeostasis",0.110,-0.978,-5.890,4.392,-4.095,0.808,0.483),
c("GO:0007291","sperm individualization",0.002,-6.518,-0.708,2.592,-4.425,0.750,0.529),
c("GO:0071257","cellular response to electrical stimulus",0.001,0.599,6.401,2.481,-4.801,0.873,0.531),
c("GO:0051602","response to electrical stimulus",0.002,0.615,5.979,2.737,-4.014,0.871,0.547),
c("GO:0035994","response to muscle stretch",0.004,0.056,6.470,2.924,-4.425,0.849,0.560),
c("GO:0016319","mushroom body development",0.002,-6.323,-1.584,2.613,-4.599,0.745,0.560),
c("GO:0002121","inter-male aggressive behavior",0.001,1.663,2.402,2.199,-4.801,0.979,0.577),
c("GO:0032091","negative regulation of protein binding",0.019,1.211,-6.564,3.630,-4.014,0.881,0.594),
c("GO:0030901","midbrain development",0.010,-5.965,-1.358,3.342,-4.272,0.726,0.652),
c("GO:0098974","postsynaptic actin cytoskeleton organization",0.001,5.355,3.262,2.400,-5.041,0.896,0.656),
c("GO:0051155","positive regulation of striated muscle cell differentiation",0.008,3.360,-3.565,3.244,-4.137,0.774,0.674));
one.data <- data.frame(revigo.data);
names(one.data) <- revigo.names;
one.data <- one.data [(one.data$plot_X != "null" & one.data$plot_Y != "null"), ];
one.data$plot_X <- as.numeric( as.character(one.data$plot_X) );
one.data$plot_Y <- as.numeric( as.character(one.data$plot_Y) );
one.data$plot_size <- as.numeric( as.character(one.data$plot_size) );
one.data$value <- as.numeric( as.character(one.data$value) );
one.data$frequency <- as.numeric( as.character(one.data$frequency) );
one.data$uniqueness <- as.numeric( as.character(one.data$uniqueness) );
one.data$dispensability <- as.numeric( as.character(one.data$dispensability) );
#head(one.data);
# --------------------------------------------------------------------------
# Names of the axes, sizes of the numbers and letters, names of the columns,
# etc. can be changed below
p1 <- ggplot( data = one.data );
p1 <- p1 + geom_point( aes( plot_X, plot_Y, colour = value, size = plot_size), alpha = I(0.6) ) + scale_size_area();
p1 <- p1 + scale_colour_gradientn( colours = c("blue", "green", "yellow", "red"), limits = c( min(one.data$value), 0) );
p1 <- p1 + geom_point( aes(plot_X, plot_Y, size = plot_size), shape = 21, fill = "transparent", colour = I (alpha ("black", 0.6) )) + scale_size_area();
p1 <- p1 + scale_size( range=c(5, 30)) + theme_bw(); # + scale_fill_gradientn(colours = heat_hcl(7), limits = c(-300, 0) );
ex <- one.data [ one.data$dispensability < 0.15, ];
p1 <- p1 + geom_text( data = ex, aes(plot_X, plot_Y, label = description), colour = I(alpha("black", 0.85)), size = 3 );
p1 <- p1 + labs (y = "semantic space x", x = "semantic space y");
p1 <- p1 + theme(legend.key = element_blank()) ;
one.x_range = max(one.data$plot_X) - min(one.data$plot_X);
one.y_range = max(one.data$plot_Y) - min(one.data$plot_Y);
p1 <- p1 + xlim(min(one.data$plot_X)-one.x_range/10,max(one.data$plot_X)+one.x_range/10);
p1 <- p1 + ylim(min(one.data$plot_Y)-one.y_range/10,max(one.data$plot_Y)+one.y_range/10);
# --------------------------------------------------------------------------
# Output the plot to screen
p1;
# Uncomment the line below to also save the plot to a file.
# The file type depends on the extension (default=pdf).
# ggsave("/path_to_your_file/revigo-plot.pdf");
revigo.names
revigo.data
library("dplyr")
library("tidyverse")
library("vegan")
library("DESeq2")
library("ggfortify")
library("WGCNA")
library("rmarkdown")
library("knitr") # for the markdown
library("kableExtra") # for creating a scrolling table
library("ggplot2") # for plotting
library("ape") # for reading the phylogenetic tree and for mantel.test
library("Biostrings")
library("ggtree") # for plotting the tree
library("ggrepel") # for spreading text labels on the plot
library("scales") # for axis labels notation
library("GO.db")
library("reshape2")
library("RSQLite")
library("AnnotationDbi")
library("GSEABase")
library("GOstats")
library("maps") # for the map background
library("leaflet") #for the interactive maps
library("htmltools")
library("rgdal")
library("grid")
library("gridExtra")
library("GeneOverlap")
library("cluster")
#the working directory is in GitHb:
setwd("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks")
# Load the expression and trait data saved in the first part
load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/varroa_virus-01-dataInput.RData");
# Load network data saved in the second part.
load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/Varroa_modules_networkConstruction-auto.RData")
annot.vd <- read.csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/VdesGOready2.csv")
#Preparing the GO frame
annot.vd2 <- annot.vd %>%
mutate(evidence = "IEA") %>%
dplyr::select(go_id = GO.ids, evidence, gene = Gene.id)
head(annot.vd2)
goFrame.vd <-GOFrame(annot.vd2, organism = "Vd")
goAllFrame.vd <-GOAllFrame(goFrame.vd)
gsc.vd <-GeneSetCollection(goAllFrame.vd, setType = GOCollection())
#Preparing the universe
universe.vd <- unique(annot.vd2$gene)
head(universe.vd)
# Preparing the gene set (list of genes in an interesting module)
# change "salmon" to the name of the desired module, in the first line: [moduleColors=="salmon"], and in the final "write.csv(file = "GO_term_enrichment_**salmon**BP.csv")
ME <- names(for_modules)[moduleColors=="black"]
ME_df <- data.frame(gene = ME)
genes.vd <- unique(ME_df$gene)
head(genes.vd)
params.vd <- GSEAGOHyperGParams(name = "Vd_GO_enrichment",
geneSetCollection = gsc.vd,
geneIds = genes.vd,
# when im changing universeGeneIds = *NULL*, then i dont get the warning
universeGeneIds = universe.vd,
ontology = "BP", # change with MF, CC to test all
pvalueCutoff = 0.05,
conditional = F,
testDirection = "over")
over.vd <- hyperGTest(params.vd)
over.vd
summary(over.vd)
GO_enrich.vd <- as.data.frame(summary(over.vd))
GO_enrich.vd %>%
arrange(Pvalue) %>%
write.csv(file = "/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/GO_term_black.csv")
#load the go term enrichment analysis done using package ‘Category’
GOME_13_0 <- read.csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/GO_term_salmon.csv")
# keep only highly significant terms
GOME_13 <- GOME_13_0 %>%
filter(Pvalue < 0.0001) %>%
mutate(logPv = log(Pvalue))
#now plot it based on the count of each term and the pvalue:
GO_13 <- ggplot(GOME_13, aes(x = 0, y = Term, size = Count, color = logPv)) +
scale_color_gradient(low= "#f0e11a", high="#f70a1a") +
geom_point(alpha = 0.9) +
geom_point(shape = 1,colour = "black") +
theme_classic() +
ggtitle("GOterm enrichment analysis \n module 13") +
xlab(label = "") +
ylab(label = "GOterm") +
scale_x_discrete()
GO_13
#load the go term enrichment analysis done using package ‘Category’
GOME_3_0 <- read.csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/GO_term_brown.csv")
# keep only highly significant terms
GOME_3 <- GOME_3_0 %>%
filter(Pvalue < 0.00001) %>%
mutate(logPv = log(Pvalue))
#now plot it based on the count of each term and the pvalue:
GO_3 <- ggplot(GOME_3, aes(x = 0, y = Term, size = Count, color = logPv)) +
scale_color_gradient(low= "#f0e11a", high="#f70a1a") +
geom_point(alpha = 0.9) +
geom_point(shape = 1,colour = "black") +
theme_classic() +
ggtitle("GOterm enrichment analysis \n module 3") +
xlab(label = "") +
ylab(label = "GOterm") +
scale_x_discrete()
GO_3
# keep only highly significant terms
GOME_3 <- GOME_3_0 %>%
filter(Pvalue < 0.0001) %>%
mutate(logPv = log(Pvalue))
#now plot it based on the count of each term and the pvalue:
GO_3 <- ggplot(GOME_3, aes(x = 0, y = Term, size = Count, color = logPv)) +
scale_color_gradient(low= "#f0e11a", high="#f70a1a") +
geom_point(alpha = 0.9) +
geom_point(shape = 1,colour = "black") +
theme_classic() +
ggtitle("GOterm enrichment analysis \n module 3") +
xlab(label = "") +
ylab(label = "GOterm") +
scale_x_discrete()
#load the go term enrichment analysis done using package ‘Category’
GOME_3_0 <- read.csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/GO_term_brown.csv")
# keep only highly significant terms
GOME_3 <- GOME_3_0 %>%
filter(Pvalue < 0.0001) %>%
mutate(logPv = log(Pvalue))
#now plot it based on the count of each term and the pvalue:
GO_3 <- ggplot(GOME_3, aes(x = 0, y = Term, size = Count, color = logPv)) +
scale_color_gradient(low= "#f0e11a", high="#f70a1a") +
geom_point(alpha = 0.9) +
geom_point(shape = 1,colour = "black") +
theme_classic() +
ggtitle("GOterm enrichment analysis \n module 3") +
xlab(label = "") +
ylab(label = "GOterm") +
scale_x_discrete()
GO_3
# keep only highly significant terms
GOME_3 <- GOME_3_0 %>%
filter(Pvalue < 0.00001) %>%
mutate(logPv = log(Pvalue))
#now plot it based on the count of each term and the pvalue:
GO_3 <- ggplot(GOME_3, aes(x = 0, y = Term, size = Count, color = logPv)) +
scale_color_gradient(low= "#f0e11a", high="#f70a1a") +
geom_point(alpha = 0.9) +
geom_point(shape = 1,colour = "black") +
theme_classic() +
ggtitle("GOterm enrichment analysis \n module 3") +
xlab(label = "") +
ylab(label = "GOterm") +
scale_x_discrete()
GO_3
#load the go term enrichment analysis done using package ‘Category’
GOME_6_0 <- read.csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/GO_term_red.csv")
# keep only highly significant terms
GOME_6 <- GOME_6_0 %>%
filter(Pvalue < 0.01) %>%
mutate(logPv = log(Pvalue))
#now plot it based on the count of each term and the pvalue:
GO_6 <- ggplot(GOME_6, aes(x = 0, y = Term, size = Count, color = logPv)) +
scale_color_gradient(low= "#f0e11a", high="#f70a1a") +
geom_point(alpha = 0.9) +
geom_point(shape = 1,colour = "black") +
theme_classic() +
ggtitle("GOterm enrichment analysis \n module 6") +
xlab(label = "") +
ylab(label = "GOterm") +
scale_x_discrete()
GO_6
GO_13
