# load the annotation file:
annot_varroa <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/annot_varroa.csv", col_names = TRUE, )
# remove the "LOC" from the gene name
annot_varroa$Locus <- str_replace(annot_varroa$Locus, "LOC", '')
# and change the col name to "genes", so it will the same as in the "overlap" table
colnames(annot_varroa)[which(names(annot_varroa) == "Locus")] <- "genes"
head(annot_varroa)
#now join by "genes" name (INNER JOIN: returns rows when there is a match in both tables)
overlap_annot <- inner_join(overlap, annot_varroa, by = "genes") %>%
dplyr::select(c(genes, module_66, module_57,
IntraModCon_66,
IntraModCon_57,
GS.DWVa_66,
GS.DWVa_57,
GS.VDV2_66,
GS.VDV2_57,
GS.ARV_2_66,
GS.ARV_2_57, Name, Accession, 'Protein product', Length, 'Protein Name'))
# and filter out duplicated genes
overlap_annot <-overlap_annot[!duplicated(overlap_annot[,'genes']),]
nrow(overlap_annot)
write_csv(x = as.data.frame(overlap_annot), "results/overlap_annot.csv")
#the working directory is in GitHb:
setwd("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks")
# load library
library(dplyr)
library(tidyverse)
library(vegan)
library(DESeq2)
library(ggfortify)
library(WGCNA)
library(rmarkdown)
library("knitr") # for the markdown
library("kableExtra") # for creating a scrolling table
library("ggplot2") # for plotting
library("ape") # for reading the phylogenetic tree and for mantel.test
library("Biostrings")
library("ggtree") # for plotting the tree
library("ggrepel") # for spreading text labels on the plot
library("scales") # for axis labels notation
library("GO.db")
library("reshape2")
library("RSQLite")
library("AnnotationDbi")
library("GSEABase")
library("GOstats")
library("maps") # for the map background
library("leaflet") #for the interactive maps
library("htmltools")
library("rgdal")
library("grid")
library("gridExtra")
library("GeneOverlap")
library(cluster)
library(ggpmisc)
library(DEGreport)
#NOTE: this code is assuming you already ran the two Rmds: "varroa_modules" and "varroa_modules_females"
# load the module network, gene expression and viral load data of the 66 libraries analysis:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/Varroa_modules_networkConstruction-auto.RData")
names
#load geneTraitSignificance (geneTraitSignificance), module membership (geneModuleMembership) and intramodular connectivity (Alldegrees1) for each gene:
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/IntraModCon66.RData")
names
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/geneTraitANDgeneMM_66.RData")
names
#load the genes tpm per library, and viral load:
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/varroa_virus-01-dataInput.RData")
names
# and of the 57 libraries analysis:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/Varroa_modules_networkConstruction-auto_57.RData")
names
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/IntraModCon57.RData")
names
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/geneTraitANDgeneMM_57.RData")
names
#load the genes tpm per library, and viral load:
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/varroa_virus-01-dataInput_57.RData")
names
#over lap the two modules tables, to check if the modules contain the same genes
# to avoid confusion, i used the module colors for the 66 libs ("moduleColors" 15 modules + grey=genes with no module), and the modules numbers for the 57 libs ("moduleLabels_57" 14 modules + "zero" = genes with no module):
compareModules <- overlapTable(
moduleColors, moduleLabels_57,
na.rm = FALSE, ignore = NULL,
levels1 = NULL, levels2 = NULL)
compareModules
# using this function i was able to match modules from the analysis including all 66 libraries, and the analysis of females only (57 libraries).
# matching modules of the two analyses
#                       66 all  == in 57 females:
# (module number 0)  MM.grey == MM.grey (module number 0)
# (module number 1)  MM.turquoise == MM.turquoise (module number 1)
# (module number 2)  MM.blue == MM.turquoise (module number 1)
# (module number 3)  MM.brown == MM.grey (module number 0)
# (module number 4)  MM.yellow == MM.red (module number 6)
# (module number 5)  MM.green == MM.blue (module number 2)
# (module number 6)  MM.red == MM.black (module number 7)
# (module number 7)  MM.black == MM.magenta (module number 9)
# (module number 8)  MM.pink == MM.pink (module number 8)
# (module number 9)  MM.magenta == MM.black (module number 7)
# (module number 10) MM.purple == MM.salmon (module number 13)
# (module number 11) MM.greenyellow == MM.greenyellow (module number 11)
# (module number 12) MM.tan == MM.pink (module number 8)ma
# (module number 13) MM.salmon == MM.purple (module number 10)
# (module number 14) MM.cyan == MM.magenta (module number 9)
geneInfoMagenta_66 = data.frame(
module = moduleColors,
geneTraitSignificance_66,
geneModuleMembership_66,
IntraModCon = Alldegrees1_66$kWithin) %>%
dplyr::select(c(module, IntraModCon, MMmagenta, GS.DWVa, GS.VDV2, GS.ARV_2)) %>%
dplyr::filter(module == "magenta") %>%
rownames_to_column("genes")
geneInfoBlack_57 = data.frame(
module = moduleColors_57,
geneTraitSignificance_57,
geneModuleMembership_57,
IntraModCon = Alldegrees1_57$kWithin) %>%
dplyr::select(c(module, IntraModCon, MMblack, GS.DWVa, GS.VDV2, GS.ARV_2)) %>%
dplyr::filter(module%in% c("black")) %>%
rownames_to_column("genes")
# make a table of the overlapping genes
overlap <- inner_join(geneInfoMagenta_66, geneInfoBlack_57, by = "genes")
#change the columns names to specify from which analysis it was taken (66libs or 57libs)
overlap <- overlap %>%
dplyr::rename(module_66 = module.x,
module_57 = module.y,
IntraModCon_66 = IntraModCon.x,
IntraModCon_57 = IntraModCon.y,
GS.DWVa_66 = GS.DWVa.x,
GS.DWVa_57 = GS.DWVa.y,
GS.VDV2_66 = GS.VDV2.x,
GS.VDV2_57 = GS.VDV2.y,
GS.ARV_2_66 = GS.ARV_2.x,
GS.ARV_2_57 = GS.ARV_2.y)
nrow(overlap)
overlap
# we have 40 overlapping genes in the magenat and balck modules, as the "overlapTable()" function computed.
# add gene annotation:
# load the annotation file:
annot_varroa <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/annot_varroa.csv", col_names = TRUE, )
# remove the "LOC" from the gene name
annot_varroa$Locus <- str_replace(annot_varroa$Locus, "LOC", '')
# and change the col name to "genes", so it will the same as in the "overlap" table
colnames(annot_varroa)[which(names(annot_varroa) == "Locus")] <- "genes"
head(annot_varroa)
#now join by "genes" name (INNER JOIN: returns rows when there is a match in both tables)
overlap_annot <- inner_join(overlap, annot_varroa, by = "genes") %>%
dplyr::select(c(genes, module_66, module_57,
IntraModCon_66,
IntraModCon_57,
GS.DWVa_66,
GS.DWVa_57,
GS.VDV2_66,
GS.VDV2_57,
GS.ARV_2_66,
GS.ARV_2_57, Name, Accession, 'Protein product', Length, 'Protein Name'))
# and filter out duplicated genes
overlap_annot <-overlap_annot[!duplicated(overlap_annot[,'genes']),]
nrow(overlap_annot)
write_csv(x = as.data.frame(overlap_annot), "results/overlap_annot.csv")
#load the former hub-genes:
hub_old <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/hub_annot_old.csv", col_names = TRUE, )
hub_old$genes <- as.character(hub_old$genes)
# how many of the hub_old genes exist in the magenta module?
#return all rows from x, and all columns from x and y.
f <- left_join(geneInfoMagenta_66, hub_old, by = "genes")
sum(!is.na(f$virus.x))
# only 3 genes of magenta module appear in the former hubgene. analysis
# so to what module these 53-hubgenes belong to?
#make a data.frame of all genes with modules:
all.genes.66 <- data.frame(
module = moduleColors,
geneTraitSignificance_66,
GSPadjust_66,
geneModuleMembership_66,
MMPadjust_66,
IntraModCon = Alldegrees1_66$kWithin) %>%
dplyr::select(c(module, IntraModCon, GS.DWVa, pdj.GS.DWVa, GS.VDV2, pdj.GS.VDV2, GS.ARV_2, pdj.GS.ARV_2, MMpurple, padj.MMpurple, MMpink, padj.MMpink)) %>%
rownames_to_column("genes")
left_join(hub_old, all.genes.66, by = "genes")
# in the 66 libs, most of them belong to the purple module
all.genes.57 <- data.frame(
module = moduleColors_57,
geneTraitSignificance_57,
GSPadjust_57,
geneModuleMembership_57,
MMPadjust_57,
IntraModCon = Alldegrees1_57$kWithin) %>%
dplyr::select(c(module, IntraModCon, GS.DWVa, pdj.GS.DWVa, GS.VDV2, pdj.GS.VDV2, GS.ARV_2, pdj.GS.ARV_2, MMsalmon, padj.MMsalmon)) %>%
rownames_to_column("genes")
left_join(hub_old, all.genes.57, by = "genes")
# in the 57 libs, most belong to the salmon module.
# what about the silenced genes? to which module they belong to?
# prepare a table describing each gene number, short-name and full annotation, of the silenced genes:
genes <- as.factor(c("111250594", "111244103","111244832", "111248360", "111245345", "111248674", "111251059", "111245371", "111244631", "111252566", "111249664"))
annot <- as.factor(c("Sarcalumenin", "glycerol-3-phosphate dehydrogenase", "Calmodulin", "Cuticle-protein8","Cuticle-protein-14", "Glutamate-receptor-3", "Glutamate-gated-chloride-channel-subunit-beta", "Organic-cation-transporter-protein", "Twitchin", "Annulin", "Defense-protein-Hdd11"))
ShortName <- as.factor(c("Sar", "Gly","clmd", "CuP8", "CuP14", "Glut", "Chl", "Trans", "Twitch", "Anl", "HDD"))
silenced.genes <- data.frame(genes, ShortName, annot)
# to what module the silenced genes belong to?
silenced_overlap.66 <- left_join(silenced.genes, all.genes.66, by = "genes")
silenced_overlap.57 <- left_join(silenced.genes, all.genes.57, by = "genes")
# of the 11 genes, 8 belong to purple module, 2 to pink and 1 to green.
# all have negative interaction with DWVa.
# to what module the silenced genes belong to?
silenced_overlap.66 <- left_join(silenced.genes, all.genes.66, by = "genes")
silenced_overlap.66
#this analysis is on the 66 and the 57 libraries
#the working directory is in GitHb:
setwd("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks")
#I save all the big outputs results in my local storage, on OneDrive:
"/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results"
# load library
library(dplyr)
library(tidyverse)
library(vegan)
library(DESeq2)
library(ggfortify)
library(WGCNA)
library(rmarkdown)
library("knitr") # for the markdown
library("kableExtra") # for creating a scrolling table
library("ggplot2") # for plotting
library("ape") # for reading the phylogenetic tree and for mantel.test
library("Biostrings")
library("ggtree") # for plotting the tree
library("ggrepel") # for spreading text labels on the plot
library("scales") # for axis labels notation
library("GO.db")
library("reshape2")
library("RSQLite")
library("AnnotationDbi")
library("GSEABase")
library("GOstats")
library("maps") # for the map background
library("leaflet") #for the interactive maps
library("htmltools")
library("rgdal")
library("grid")
library("gridExtra")
library("GeneOverlap")
library(cluster)
library(ggpmisc)
library(DEGreport)
#NOTE: this code is assuming you already ran the two Rmds: "varroa_modules" and "varroa_modules_females"
# load the module network, gene expression and viral load data of the 66 libraries analysis:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/Varroa_modules_networkConstruction-auto.RData")
names
#load geneTraitSignificance (geneTraitSignificance), module membership (geneModuleMembership) and intramodular connectivity (Alldegrees1) for each gene:
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/IntraModCon66.RData")
names
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/geneTraitANDgeneMM_66.RData")
names
#load the genes tpm per library, and viral load:
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/varroa_virus-01-dataInput.RData")
names
#load the correlation data for the module-trait relationship:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/moduleTraitCor_66.RData")
names
# and of the 57 libraries analysis:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/Varroa_modules_networkConstruction-auto_57.RData")
names
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/IntraModCon57.RData")
names
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/geneTraitANDgeneMM_57.RData")
names
#load the genes tpm per library, and viral load:
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/varroa_virus-01-dataInput_57.RData")
names
#load the correlation data for the module-trait relationship:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/moduleTraitCor_57.RData")
names
#over lap the two modules tables, to check if the modules contain the same genes
# to avoid confusion, i used the module colors for the 66 libs ("moduleColors" 15 modules + grey=genes with no module), and the modules numbers for the 57 libs ("moduleLabels_57" 14 modules + "zero" = genes with no module):
compareModules <- overlapTable(
moduleColors, moduleLabels_57,
na.rm = FALSE, ignore = NULL,
levels1 = NULL, levels2 = NULL)
compareModules
# using this function i was able to match modules from the analysis including all 66 libraries, and the analysis of females only (57 libraries).
# matching modules of the two analyses
#                       66 all  == in 57 females:
# (module number 0)  MM.grey == MM.grey (module number 0)
# (module number 1)  MM.turquoise == MM.turquoise (module number 1)
# (module number 2)  MM.blue == MM.turquoise (module number 1)
# (module number 3)  MM.brown == MM.grey (module number 0)
# (module number 4)  MM.yellow == MM.red (module number 6)
# (module number 5)  MM.green == MM.blue (module number 2)
# (module number 6)  MM.red == MM.black (module number 7)
# (module number 7)  MM.black == MM.magenta (module number 9)
# (module number 8)  MM.pink == MM.pink (module number 8)
# (module number 9)  MM.magenta == MM.black (module number 7)
# (module number 10) MM.purple == MM.salmon (module number 13)
# (module number 11) MM.greenyellow == MM.greenyellow (module number 11)
# (module number 12) MM.tan == MM.pink (module number 8)ma
# (module number 13) MM.salmon == MM.purple (module number 10)
# (module number 14) MM.cyan == MM.magenta (module number 9)
geneInfoMagenta_66 = data.frame(
module = moduleColors,
geneTraitSignificance_66,
geneModuleMembership_66,
IntraModCon = Alldegrees1_66$kWithin) %>%
dplyr::select(c(module, IntraModCon, MMmagenta, GS.DWVa, GS.VDV2, GS.ARV_2)) %>%
dplyr::filter(module == "magenta") %>%
rownames_to_column("genes")
geneInfoBlack_57 = data.frame(
module = moduleColors_57,
geneTraitSignificance_57,
geneModuleMembership_57,
IntraModCon = Alldegrees1_57$kWithin) %>%
dplyr::select(c(module, IntraModCon, MMblack, GS.DWVa, GS.VDV2, GS.ARV_2)) %>%
dplyr::filter(module%in% c("black")) %>%
rownames_to_column("genes")
# make a table of the overlapping genes
overlap <- inner_join(geneInfoMagenta_66, geneInfoBlack_57, by = "genes")
#change the columns names to specify from which analysis it was taken (66libs or 57libs)
overlap <- overlap %>%
dplyr::rename(module_66 = module.x,
module_57 = module.y,
IntraModCon_66 = IntraModCon.x,
IntraModCon_57 = IntraModCon.y,
GS.DWVa_66 = GS.DWVa.x,
GS.DWVa_57 = GS.DWVa.y,
GS.VDV2_66 = GS.VDV2.x,
GS.VDV2_57 = GS.VDV2.y,
GS.ARV_2_66 = GS.ARV_2.x,
GS.ARV_2_57 = GS.ARV_2.y)
nrow(overlap)
overlap
# we have 40 overlapping genes in the magenat and balck modules, as the "overlapTable()" function computed.
# add gene annotation:
# load the annotation file:
annot_varroa <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/annot_varroa.csv", col_names = TRUE, )
# remove the "LOC" from the gene name
annot_varroa$Locus <- str_replace(annot_varroa$Locus, "LOC", '')
# and change the col name to "genes", so it will the same as in the "overlap" table
colnames(annot_varroa)[which(names(annot_varroa) == "Locus")] <- "genes"
head(annot_varroa)
#now join by "genes" name (INNER JOIN: returns rows when there is a match in both tables)
overlap_annot <- inner_join(overlap, annot_varroa, by = "genes") %>%
dplyr::select(c(genes, module_66, module_57,
IntraModCon_66,
IntraModCon_57,
GS.DWVa_66,
GS.DWVa_57,
GS.VDV2_66,
GS.VDV2_57,
GS.ARV_2_66,
GS.ARV_2_57, Name, Accession, 'Protein product', Length, 'Protein Name'))
# and filter out duplicated genes
overlap_annot <-overlap_annot[!duplicated(overlap_annot[,'genes']),]
nrow(overlap_annot)
write_csv(x = as.data.frame(overlap_annot), "results/overlap_annot.csv")
#load the former hub-genes:
hub_old <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/hub_annot_old.csv", col_names = TRUE, )
hub_old$genes <- as.character(hub_old$genes)
# how many of the hub_old genes exist in the magenta module?
#return all rows from x, and all columns from x and y.
f <- left_join(geneInfoMagenta_66, hub_old, by = "genes")
sum(!is.na(f$virus.x))
# only 3 genes of magenta module appear in the former hubgene. analysis
# so to what module these 53-hubgenes belong to?
#make a data.frame of all genes with modules:
all.genes.66 <- data.frame(
module = moduleColors,
geneTraitSignificance_66,
GSPadjust_66,
geneModuleMembership_66,
MMPadjust_66,
IntraModCon = Alldegrees1_66$kWithin) %>%
dplyr::select(c(module, IntraModCon, GS.DWVa, pdj.GS.DWVa, GS.VDV2, pdj.GS.VDV2, GS.ARV_2, pdj.GS.ARV_2, MMpurple, padj.MMpurple, MMpink, padj.MMpink)) %>%
rownames_to_column("genes")
left_join(hub_old, all.genes.66, by = "genes")
# in the 66 libs, most of them belong to the purple module
all.genes.57 <- data.frame(
module = moduleColors_57,
geneTraitSignificance_57,
GSPadjust_57,
geneModuleMembership_57,
MMPadjust_57,
IntraModCon = Alldegrees1_57$kWithin) %>%
dplyr::select(c(module, IntraModCon, GS.DWVa, pdj.GS.DWVa, GS.VDV2, pdj.GS.VDV2, GS.ARV_2, pdj.GS.ARV_2, MMsalmon, padj.MMsalmon)) %>%
rownames_to_column("genes")
left_join(hub_old, all.genes.57, by = "genes")
# in the 57 libs, most belong to the salmon module.
# what about the silenced genes? to which module they belong to?
# prepare a table describing each gene number, short-name and full annotation, of the silenced genes:
genes <- as.factor(c("111250594", "111244103","111244832", "111248360", "111245345", "111248674", "111251059", "111245371", "111244631", "111252566", "111249664"))
annot <- as.factor(c("Sarcalumenin", "glycerol-3-phosphate dehydrogenase", "Calmodulin", "Cuticle-protein8","Cuticle-protein-14", "Glutamate-receptor-3", "Glutamate-gated-chloride-channel-subunit-beta", "Organic-cation-transporter-protein", "Twitchin", "Annulin", "Defense-protein-Hdd11"))
ShortName <- as.factor(c("Sar", "Gly","clmd", "CuP8", "CuP14", "Glut", "Chl", "Trans", "Twitch", "Anl", "HDD"))
silenced.genes <- data.frame(genes, ShortName, annot)
# to what module the silenced genes belong to?
silenced_overlap.66 <- left_join(silenced.genes, all.genes.66, by = "genes")
silenced_overlap.57 <- left_join(silenced.genes, all.genes.57, by = "genes")
# of the 11 genes, 8 belong to purple module, 2 to pink and 1 to green.
# all have negative interaction with DWVa.
sizeGrWindow(10,6)
# Will display correlations and their p-values
textMatrix = paste(signif(moduleTraitCor_66, 2), "\n(",
signif(moduleTraitPadjust_66, 1), ")", sep = "");
dim(textMatrix) = dim(moduleTraitCor_66)
par(mar = c(6, 8.5, 3, 3));
# Display the correlation values within a heatmap plot
labeledHeatmap(Matrix = moduleTraitCor_66,
xLabels = names(b_viruses_load),
yLabels = names(MEs),
ySymbols = names(MEs),
colorLabels = FALSE,
colors = blueWhiteRed(50),
textMatrix = textMatrix,
setStdMargins = FALSE,
cex.text = 0.7,
zlim = c(-1,1),
main = paste("Varroa Module-viruses relationships"))
# first Recalculate MEs with color labels
MEs0 = moduleEigengenes(for_modules, moduleColors)$eigengenes
MEs = orderMEs(MEs0)
sizeGrWindow(10,6)
# Will display correlations and their p-values
textMatrix = paste(signif(moduleTraitCor_66, 2), "\n(",
signif(moduleTraitPadjust_66, 1), ")", sep = "");
dim(textMatrix) = dim(moduleTraitCor_66)
par(mar = c(6, 8.5, 3, 3));
# Display the correlation values within a heatmap plot
labeledHeatmap(Matrix = moduleTraitCor_66,
xLabels = names(b_viruses_load),
yLabels = names(MEs),
ySymbols = names(MEs),
colorLabels = FALSE,
colors = blueWhiteRed(50),
textMatrix = textMatrix,
setStdMargins = FALSE,
cex.text = 0.7,
zlim = c(-1,1),
main = paste("Varroa Module-viruses relationships"))
# first Recalculate MEs with color labels
MEs0 = moduleEigengenes(for_modules, moduleColors)$eigengenes
MEs = orderMEs(MEs0)
sizeGrWindow(10,6)
# Will display correlations and their p-values
textMatrix = paste(signif(moduleTraitCor_66, 2), "\n(",
signif(moduleTraitPadjust_66, 1), ")", sep = "");
dim(textMatrix) = dim(moduleTraitCor_66)
par(mar = c(6, 8.5, 3, 3));
# Display the correlation values within a heatmap plot
labeledHeatmap(Matrix = moduleTraitCor_66,
xLabels = names(b_viruses_load),
yLabels = names(MEs),
ySymbols = names(MEs),
colorLabels = FALSE,
colors = blueWhiteRed(50),
textMatrix = textMatrix,
setStdMargins = FALSE,
cex.text = 0.7,
zlim = c(-1,1),
main = paste("Varroa Module-viruses relationships, all 66 libraries"))
## (1) virus > module (virus tpm > module eigengene). for the 66 libraries
# first Recalculate MEs with color labels
MEs0 = moduleEigengenes(for_modules_female, moduleColors_57)$eigengenes
MEs_57 = orderMEs(MEs0)
sizeGrWindow(10,6)
# Will display correlations and their p-values
textMatrix = paste(signif(moduleTraitCor_57, 2), "\n(",
signif(moduleTraitPadjust_57, 1), ")", sep = "");
dim(textMatrix) = dim(moduleTraitCor_57)
par(mar = c(6, 8.5, 3, 3));
# Display the correlation values within a heatmap plot
labeledHeatmap(Matrix = moduleTraitCor_57,
xLabels = names(b_viruses_load_57),
yLabels = names(MEs_57),
ySymbols = names(MEs_57),
colorLabels = FALSE,
colors = blueWhiteRed(50),
textMatrix = textMatrix,
setStdMargins = FALSE,
cex.text = 0.7,
zlim = c(-1,1),
main = paste("Varroa Module-viruses relationships females only libraries"))
moduleTraitCor_66
# Display the correlation values within a heatmap plot
heat66 <- labeledHeatmap(Matrix = moduleTraitCor_66,
xLabels = names(b_viruses_load),
yLabels = names(MEs),
ySymbols = names(MEs),
colorLabels = FALSE,
colors = blueWhiteRed(50),
textMatrix = textMatrix,
setStdMargins = FALSE,
cex.text = 0.7,
zlim = c(-1,1),
main = paste("Varroa Module-viruses relationships, all 66 libraries"))
## (1) virus > module (virus tpm > module eigengene). for the 66 libraries
# first Recalculate MEs with color labels
MEs0 = moduleEigengenes(for_modules_female, moduleColors_57)$eigengenes
MEs_57 = orderMEs(MEs0)
sizeGrWindow(10,6)
# Will display correlations and their p-values
textMatrix = paste(signif(moduleTraitCor_57, 2), "\n(",
signif(moduleTraitPadjust_57, 1), ")", sep = "");
dim(textMatrix) = dim(moduleTraitCor_57)
par(mar = c(6, 8.5, 3, 3));
# Display the correlation values within a heatmap plot
heat57 <- labeledHeatmap(Matrix = moduleTraitCor_57,
xLabels = names(b_viruses_load_57),
yLabels = names(MEs_57),
ySymbols = names(MEs_57),
colorLabels = FALSE,
colors = blueWhiteRed(50),
textMatrix = textMatrix,
setStdMargins = FALSE,
cex.text = 0.7,
zlim = c(-1,1),
main = paste("Varroa Module-viruses relationships females only libraries"))
heat57
