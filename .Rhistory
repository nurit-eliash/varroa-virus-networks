library("GeneOverlap")
library("cluster")
library("ggpubr")
library("GGally")
geneInfoMagenta_66 = data.frame(
module = moduleColors,
geneTraitSignificance_66,
geneModuleMembership_66,
IntraModCon = Alldegrees1_66$kWithin)
geneInfoMagenta_66
# load the module network, gene expression and viral load data of the 66 libraries analysis:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/Varroa_modules_networkConstruction-auto.RData")
names
#load geneTraitSignificance (geneTraitSignificance), module membership (geneModuleMembership) and intramodular connectivity (Alldegrees1) for each gene:
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/IntraModCon66.RData")
names
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/geneTraitANDgeneMM_66.RData")
names
#load the genes tpm per library, and viral load:
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/varroa_virus-01-dataInput.RData")
names
#load the correlation data for the module-trait relationship:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/moduleTraitCor_66.RData")
names
# load the gene ID of the varroa RNAi-genes (based on Nganso et al. 2020)
RNAi_genes <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/varroa_RNAi.csv")
library("dplyr")
library("tidyverse")
library("vegan")
library("DESeq2")
library("ggfortify")
library("WGCNA")
library("rmarkdown")
library("knitr") # for the markdown
library("kableExtra") # for creating a scrolling table
library("ggplot2") # for plotting
library("ape") # for reading the phylogenetic tree and for mantel.test
library("Biostrings")
library("ggtree") # for plotting the tree
library("ggrepel") # for spreading text labels on the plot
library("scales") # for axis labels notation
library("GO.db")
library("reshape2")
library("RSQLite")
library("AnnotationDbi")
library("GSEABase")
library("GOstats")
library("maps") # for the map background
library("leaflet") #for the interactive maps
library("htmltools")
library("rgdal")
library("grid")
library("gridExtra")
library("GeneOverlap")
library("cluster")
library("ggpubr")
library("GGally")
geneInfoMagenta_66 = data.frame(
module = moduleColors,
geneTraitSignificance_66,
geneModuleMembership_66,
IntraModCon = Alldegrees1_66$kWithin)
View(geneInfoMagenta_66)
geneInfo <- data.frame(
module = moduleColors,
geneTraitSignificance_66,
geneModuleMembership_66,
IntraModCon = Alldegrees1_66$kWithin) %>%
rownames_to_column("genes")
View(geneInfo)
# join the varroa RNAi-genes and the all "geneInfo" table
RNAi <- inner_join(geneInfo, RNAi_genes, by = "genes")
geneInfo
RNAi_genes
# make a datafrmae with all genes and their info: module assignment, virus interaction, modules membership and Intramodule connectivity:
geneInfo <- data.frame(
module = moduleColors,
geneTraitSignificance_66,
geneModuleMembership_66,
IntraModCon = Alldegrees1_66$kWithin) %>%
rownames_to_column("gene")
# join the varroa RNAi-genes and the all "geneInfo" table
RNAi <- inner_join(geneInfo, RNAi_genes, by = "gene")
# load the gene ID of the varroa RNAi-genes (based on Nganso et al. 2020)
RNAi_genes <- as.character(read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/varroa_RNAi.csv"))
RNAi_genes
# load the gene ID of the varroa RNAi-genes (based on Nganso et al. 2020)
RNAi_genes <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/varroa_RNAi.csv") %>%
as.character("gene")
RNAi_genes
# load the gene ID of the varroa RNAi-genes (based on Nganso et al. 2020)
RNAi_genes <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/varroa_RNAi.csv")
RNAi_genes
RNAi_genes <- as.character(RNAi_genes$gene)
RNAi_genes
# load the gene ID of the varroa RNAi-genes (based on Nganso et al. 2020)
RNAi_genes <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/varroa_RNAi.csv")
RNAi_genes$gene <- as.character(RNAi_genes$gene)
RNAi_genes
# make a datafrmae with all genes and their info: module assignment, virus interaction, modules membership and Intramodule connectivity:
geneInfo <- data.frame(
module = moduleColors,
geneTraitSignificance_66,
geneModuleMembership_66,
IntraModCon = Alldegrees1_66$kWithin) %>%
rownames_to_column("gene")
# join the varroa RNAi-genes and the all "geneInfo" table
RNAi <- inner_join(geneInfo, RNAi_genes, by = "gene")
RNAi
View(RNAi)
# join the varroa RNAi-genes and the all "geneInfo" table
RNAi <- inner_join(RNAi_genes, geneInfo, by = "gene")
RNAi
#plot the gene distribution accordring to module
p <- ggplot(RNAi, module)
#plot the gene distribution accordring to module
p <- ggplot(RNAi, mapping = aes(x = module)
#plot the gene distribution accordring to module
p <- ggplot(RNAi, mapping = aes(x = module))
#plot the gene distribution accordring to module
p <- ggplot(RNAi, aes(x=module, fill=module)) +
geom_histogram(binwidth=.5, alpha=.5, position="identity")
p
#plot the gene distribution accordring to module
p <- ggplot(RNAi, aes(x=module, fill=module), stat="count") +
geom_histogram(binwidth=.5, alpha=.5, position="identity")
#plot the gene distribution accordring to module
ggplot(RNAi, aes(x=module, fill=module), stat="count") +
geom_histogram(binwidth=.5, alpha=.5, position="identity")
ggplot(RNAi, mapping = aes(x = module))
#plot the gene distribution accordring to module
ggplot(RNAi, aes(x=module, fill=module, fill = gene), stat="count") +
geom_histogram(binwidth=.5, alpha=.5, position="identity")
#plot the gene distribution accordring to module
ggplot(RNAi, aes(x=module, fill = gene), stat="count") +
geom_histogram(binwidth=.5, alpha=.5, position="identity")
#plot the gene distribution accordring to module
ggplot(RNAi, aes(x=module, y = gene), stat="count") +
geom_histogram(binwidth=.5, alpha=.5, position="identity")
#plot the gene distribution accordring to module
ggplot(RNAi, aes(x=module), stat="count") +
geom_histogram(binwidth=.5, alpha=.5, position="identity")
ggplot(RNAi, aes(x=module)) + geom_histogram(binwidth=.5)
ggplot(RNAi, aes(x=module))
ggplot(RNAi, aes(module)) +geom_bar()
#plot the gene distribution according to module
ggplot(RNAi, aes(module)) + geom_bar() +
ggtitle("RNAi gene module distribution")
#plot the gene distribution according to module
ggplot(RNAi, aes(module)) + geom_bar() +
ggtitle("RNAi gene distribution to modules")
geneInfo
# before joining the tables, take out the SRA columns:
Modules <- MEs %>%
rownames_to_column("library")
viruses_load <- b_viruses_load %>%
rownames_to_column("library")
# make a new table with SRAs as rows, and viral loads and modules in the columns:
dat <- left_join(viruses_load, Modules, by = "library")
View(dat)
View(dat)
# plot the gene interaction with the different viruses
viruses_load <- b_viruses_load %>%
rownames_to_column("library")
viruses_load
View(RNAi)
View(for_modules)
genes <- for_modules %>%
rownames_to_column("library")
#plot the gene distribution according to module
ggplot(RNAi, aes(module), fill = family) + geom_bar() +
ggtitle("RNAi gene distribution to modules")
#plot the gene distribution according to module
ggplot(RNAi, aes(module, fill = family)) + geom_bar() +
ggtitle("RNAi gene distribution to modules")
#load the correlation data for the module-trait relationship:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/moduleTraitCor_66.RData")
names
# and of the 57 libraries analysis:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/Varroa_modules_networkConstruction-auto_57.RData")
moduleTraitCor_66
class(moduleTraitCor_66)
moduleTraitCor_66
# make correlation matrix of the "moduleTraitCor":
corModulTrait_66 <- cor(moduleTraitCor_66)
corModulTrait_66
corModulTrait_66
class(corModulTrait_66)
suppressPackageStartupMessages(library(tidyverse))
library(dplyr)
library(tidyverse)
library(ggplot2)
library(Rmisc)
library(ggpubr)
library(anchors)
library(broom)
library(HDInterval)
library(coda)
library(brms)
library(devtools)
library(rjags)
library(BEST)
library(ggpubr)
library(ggthemes)
library(car)
library(stats)
library(moments)
library(intervcomp)
library(grid)
library(formattable)
library(gridExtra)
library(ggsignif)
library(patchwork)
library(cowplot)
library(AMR)
dat_survival <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-knockdown/data/RNAi_survival.csv")
dat_virus <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-knockdown/data/virus_in_silenced.csv")
dat_gene <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-knockdown/data/Silencing_qPCR.csv")
dat_gene <- dat_gene %>%
filter((Treatment %in% c("Silenced", "Control"))) %>%
filter(Time == "48h")
CuP8 <- filter(dat_gene, Gene == "CuP8")
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("#00AFBB", "#E7B800"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("#00AFBB", "#E7B800"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30)) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
suppressPackageStartupMessages(library(tidyverse))
library(dplyr)
library(tidyverse)
library(ggplot2)
library(Rmisc)
library(ggpubr)
library(anchors)
library(broom)
library(HDInterval)
library(coda)
library(brms)
library(devtools)
library(rjags)
library(BEST)
library(ggpubr)
library(ggthemes)
library(car)
library(stats)
library(moments)
library(intervcomp)
library(grid)
library(formattable)
library(gridExtra)
library(ggsignif)
library(patchwork)
library(cowplot)
library(AMR)
dat_survival <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-knockdown/data/RNAi_survival.csv")
dat_virus <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-knockdown/data/virus_in_silenced.csv")
dat_gene <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-knockdown/data/Silencing_qPCR.csv")
dat_gene <- dat_gene %>%
filter((Treatment %in% c("Silenced", "Control"))) %>%
filter(Time == "48h")
CuP8 <- filter(dat_gene, Gene == "CuP8")
pCuP8 <- ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
,
axis.ticks.x=element_blank()
VDV2_CuP8 <- filter(dat_virus, Gene == "VDV2" & Experiment == "CuP8_exp")
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0))
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
#annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank())
ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank())
ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(), axis.ticks.x=element_blank())
View(moduleTraitPvalue_0)
#  Display correlations and their adjusted p-values
textMatrix = paste(signif(moduleTraitCor_66, 2), "\n(",
signif(moduleTraitPadjust, 1), ")", sep = "");
dim(textMatrix) = dim(moduleTraitCor_66)
par(mar = c(6, 8.5, 3, 3));
# Display the correlation values within a heatmap plot
labeledHeatmap(Matrix = moduleTraitCor_66,
xLabels = names(viruses_load_15),
yLabels = names(MEs),
#xLabelsAngle = 90,
ySymbols = names(MEs),
colorLabels = FALSE,
colors = hcl.colors(n = 50, palette = "RdBu", alpha = NULL, rev = FALSE, fixup = TRUE),
invertColors = TRUE,
textMatrix = textMatrix,
setStdMargins = FALSE,
cex.text = 0.7,
zlim = c(-1,1),
main = paste("Varroa Module-viruses relationships"))
# save the matrices for next analyses
#save(moduleTraitCor_66,moduleTraitPadjust_66, file = "/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/moduleTraitCor_66.RData")
library("dplyr")
library("tidyverse")
library("vegan")
library("DESeq2")
library("ggfortify")
library("WGCNA")
options(stringsAsFactors = FALSE) # Allow multi-threading within WGCNA. This helps speed up certain calculations.
library("rmarkdown")
library("knitr") # for the markdown
library("kableExtra") # for creating a scrolling table
library("ggplot2") # for plotting
library("ape") # for mantel.test
library("Biostrings")
library("ggrepel") # for spreading text labels on the plot
library("scales") # for axis labels notation
library("GO.db") # for GO term annotation
library("reshape2")
library("RSQLite")
library("AnnotationDbi") # for GO term annotation
library("GSEABase")
library("GOstats")
library("maps") # for the map background
library("htmltools")
library("rgdal")
library("grid")
library("gridExtra")
library("GeneOverlap") # for making the overlapping genes
library("cluster")
library("rmdformats")
library("corrplot") # for virus-virus correlation
library("viridis")
library("hrbrthemes")
library("ggthemes")
library("RColorBrewer")
library("naniar")
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks") #set the directory as the local GitHub local repository
install.packages("kableExtra")
install.packages("kableExtra")
library("kableExtra")
read.csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/GO_term_black.csv")
GO_term_black <- read.csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/GO_term_black.csv")
GO_term_black
View(GO_term_black)
GO_term_black %>%
kbl() %>%
kable_styling()
GO_term_black <- read.csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/GO_term_black.csv")
GO_term_black %>%
kbl() %>%
kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
GO_term_black %>%
kbl() %>%
kable_styling(bootstrap_options = "striped", full_width = F, position = "left") %>%
kable_paper() %>%
scroll_box(width = "500px", height = "200px")
GO_term_turquoise <- read.csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/GO_term_turquoise.csv")
GO_term_turquoise %>%
kbl() %>%
kable_styling(bootstrap_options = "striped", full_width = F, position = "left") %>%
kable_paper() %>%
scroll_box(width = "500px", height = "200px")
GO_term_brown <- read.csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/GO_term_brown.csv")
GO_term_brown %>%
kbl() %>%
kable_styling(bootstrap_options = "striped", full_width = F, position = "left") %>%
kable_paper() %>%
scroll_box(width = "500px", height = "200px")
GO_term_black <- read.csv("https://github.com/nurit-eliash/varroa-virus-networks/blob/master/results/GO_term_black.csv")
GO_term_black
GO_term_black <- read.csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/GO_term_black.csv")
GO_term_black %>%
kbl() %>%
kable_styling(bootstrap_options = "striped", full_width = F, position = "left") %>%
kable_paper() %>%
scroll_box(width = "500px", height = "200px")
