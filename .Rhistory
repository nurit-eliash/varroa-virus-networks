theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
# for VDV2 in CuP8 silenced mites:
VDV2_CuP8 <- filter(dat_virus, Gene == "VDV2" & Experiment == "CuP8_exp")
# Plot
pVDV2_CuP8 <- ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "*",
y_position = 2.2,
lwd = 0)
# for ARV2 in CuP8 silenced mites:
ARV2_CuP8 <- filter(dat_virus, Gene == "ARV2" & Experiment == "CuP8_exp")
# Plot
pARV2_CuP8 <- ggboxplot(ARV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "ARV-2 viral load")  +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "*",
y_position = 20,
lwd = 0)
#plot CuP8 gene expression and the viruses load
grid.arrange(pCuP8, pVDV2_CuP8, pARV2_CuP8, pDWVa_CuP8 , nrow = 1)
pCuP8
### plot Figure 3a for the MS
pCuP8 <- ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("#00AFBB", "#E7B800"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
pCuP8
pCuP8 <- ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("black", "white"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
pCuP8
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("black", "white"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression",
remove = "median")  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("black", "white"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression",
fatten = NULL)  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
pCuP8 <- ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("black", "white"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression",
fatten = NULL)  +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
pCuP8
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("black", "white"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
geom_boxplot(flatten = NULL) +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("black", "white"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
geom_boxplot(fatten = NULL) +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression",
remove = "median") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression",
medcol="red") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
boxplot(medcol="red") +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(medcol="red") +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
geom_segment(medcol="red") +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
geom_segment(medcol="red") + theme(axis.title.y = element_text(margin = margin(r = 10))) +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
geom_segment(CuP8, medcol="red") +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
geom_segment(CuP8, aes(x = "Treatment", y = "RQ"), medcol="red") +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
geom_segment(CuP8,  color="red") +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
#theme(panel.background = element_rect(fill = 'lightgray')) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
y_position = 4,
lwd = 0)
VDV2_CuP8 <- filter(dat_virus, Gene == "VDV2" & Experiment == "CuP8_exp")
pVDV2_CuP8 <- ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
color = "Treatment", lwd=2,
palette = c("#00AFBB", "#E7B800"),
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "*",
y_position = 2.2,
lwd = 0)
pVDV2_CuP8
ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "*",
y_position = 2.2,
lwd = 0)
pVDV2_CuP8 <- ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "*",
y_position = 2.2,
lwd = 0)
pVDV2_CuP8
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "down", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "up", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "left", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
lwd = 0)
ggboxplot(VDV2_CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative viral load", xlab = "VDV2 viral load") +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "*",
y_position = 2.2,
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
lwd = 0)
ggboxplot(CuP8, x = "Treatment", y = "RQ",
fill = "Treatment", palette = c("white", "black"), lwd=2,
order = c("Control", "Silenced"),
ylab = "Relative gene expression", xlab = "CuP8 gene expression") +
theme(axis.title.y = element_text(margin = margin(r = 10))) +
theme(legend.position = "none", text = element_text(size=30), axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
geom_signif(comparisons = list(c("Control", "Silenced")),
textsize = 20,
annotations = "***",
lwd = 0)
# load the module network, gene expression and viral load data of the 66 libraries analysis:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/Varroa_modules_networkConstruction-auto.RData")
names
#load geneTraitSignificance (geneTraitSignificance), module membership (geneModuleMembership) and intramodular connectivity (Alldegrees1) for each gene:
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/IntraModCon66.RData")
names
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/geneTraitANDgeneMM_66.RData")
names
#load the genes tpm per library, and viral load:
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/varroa_virus-01-dataInput.RData")
names
#load the correlation data for the module-trait relationship:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/moduleTraitCor_66.RData")
names
# load the gene ID of the varroa RNAi-genes (based on Nganso et al. 2020)
RNAi_genes <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/varroa_RNAi.csv")
RNAi_genes$gene <- as.character(RNAi_genes$gene)
# load the gene ID of the varroa RNAi-genes (based on Nganso et al. 2020)
RNAi_genes <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/varroa_RNAi.csv")
library("dplyr")
library("tidyverse")
library("vegan")
library("DESeq2")
library("ggfortify")
library("WGCNA")
library("rmarkdown")
library("knitr") # for the markdown
library("kableExtra") # for creating a scrolling table
library("ggplot2") # for plotting
library("ape") # for reading the phylogenetic tree and for mantel.test
library("Biostrings")
library("ggtree") # for plotting the tree
library("ggrepel") # for spreading text labels on the plot
library("scales") # for axis labels notation
library("GO.db")
library("reshape2")
library("RSQLite")
library("AnnotationDbi")
library("GSEABase")
library("GOstats")
library("maps") # for the map background
library("leaflet") #for the interactive maps
library("htmltools")
library("rgdal")
library("grid")
library("gridExtra")
library("GeneOverlap")
library("cluster")
library("ggpubr")
library("GGally")
# load the module network, gene expression and viral load data of the 66 libraries analysis:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/Varroa_modules_networkConstruction-auto.RData")
names
#load geneTraitSignificance (geneTraitSignificance), module membership (geneModuleMembership) and intramodular connectivity (Alldegrees1) for each gene:
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/IntraModCon66.RData")
names
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/geneTraitANDgeneMM_66.RData")
names
#load the genes tpm per library, and viral load:
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/varroa_virus-01-dataInput.RData")
names
#load the correlation data for the module-trait relationship:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/moduleTraitCor_66.RData")
names
# load the gene ID of the varroa RNAi-genes (based on Nganso et al. 2020)
RNAi_genes <- read_csv("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/data/varroa_RNAi.csv")
RNAi_genes$gene <- as.character(RNAi_genes$gene)
setwd("/Users/nuriteliash/Documents/GitHub/varroa-virus-networks")
knitr::opts_chunk$set(echo = TRUE)
# make a dataframe with all genes and their info: module assignment, virus interaction, modules membership and Intramodule connectivity:
geneInfo <- data.frame(
module = moduleColors,
geneTraitSignificance_66,
geneModuleMembership_66,
IntraModCon = Alldegrees1_66$kWithin) %>%
rownames_to_column("gene")
# join the varroa RNAi-genes and the all "geneInfo" table
RNAi <- inner_join(RNAi_genes, geneInfo, by = "gene")
RNAi
View(RNAi)
#plot the gene distribution according to module
ggplot(RNAi, aes(module, fill = family)) + geom_bar() +
ggtitle("RNAi gene distribution to modules")
RNAi_tpm <- for_modules %>%
rownames_to_column("library")
RNAi_tpm
#load the viruses load, per library
viruses_load <- b_viruses_load %>%
rownames_to_column("library")
# make a new table with SRAs as rows, and viral loads and modules in the columns:
dat <- left_join(viruses_load, Modules, by = "library")
#save the RNAi varroa genes and their module as csv
write_csv(RNAi, "/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/varroa_RNAi_modules")
#save the RNAi varroa genes and their module as csv
write_csv(RNAi, "/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/varroa_RNAi_modules.csv")
geneTraitSignificance_66
#load the correlation data for the module-trait relationship:
names <- load("/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/moduleTraitCor_66.RData")
names
moduleTraitPadjust_66
geneTraitSignificance_66
names <- load(file = "/Users/nuriteliash/OneDrive - OIST/Repos/varroa-virus-networks-Local/results/geneTraitANDgeneMM_66.RData")
names
GSPadjust_66
# make a dataframe with all genes and their info: module assignment, virus interaction, modules membership and Intramodule connectivity:
geneInfo <- data.frame(
module = moduleColors,
geneTraitSignificance_66,
GSPadjust_66,
geneModuleMembership_66,
IntraModCon = Alldegrees1_66$kWithin) %>%
rownames_to_column("gene")
# join the varroa RNAi-genes and the all "geneInfo" table
RNAi <- inner_join(RNAi_genes, geneInfo, by = "gene")
#plot the gene distribution according to module
ggplot(RNAi, aes(module, fill = family)) + geom_bar() +
ggtitle("RNAi gene distribution to modules")
#save the RNAi varroa genes and their module as csv
write_csv(RNAi, "/Users/nuriteliash/Documents/GitHub/varroa-virus-networks/results/varroa_RNAi_modules.csv")
